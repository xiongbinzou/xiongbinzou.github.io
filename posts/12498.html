<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Django-Vue搭建个人博客(4)：前端功能完善 | 小邹同学</title><meta name="keywords" content="Django,Django REST framework,Vue,前后端分离"><meta name="author" content="小邹同学"><meta name="copyright" content="小邹同学"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="本教程是一个以前后端分离模式开发个人博客的教程，目的是快速搭建现代化个人博客网站。"><meta property="og:type" content="article"><meta property="og:title" content="Django-Vue搭建个人博客(4)：前端功能完善"><meta property="og:url" content="https://xiongbinzou.github.io/posts/12498.html"><meta property="og:site_name" content="小邹同学"><meta property="og:description" content="本教程是一个以前后端分离模式开发个人博客的教程，目的是快速搭建现代化个人博客网站。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://xiongbinzou.github.io/pics/avatar.jpg"><meta property="article:published_time" content="2023-04-06T13:00:00.000Z"><meta property="article:modified_time" content="2023-04-10T10:30:15.662Z"><meta property="article:author" content="小邹同学"><meta property="article:tag" content="Django"><meta property="article:tag" content="Django REST framework"><meta property="article:tag" content="Vue"><meta property="article:tag" content="前后端分离"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://xiongbinzou.github.io/pics/avatar.jpg"><link rel="shortcut icon" href="/pics/favicon.png"><link rel="canonical" href="https://xiongbinzou.github.io/posts/12498"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"prismjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{limitCount:300,languages:{author:"作者: 小邹同学",link:"链接: ",source:"来源: 小邹同学",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体",cht_to_chs:"你已切换为简体",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#121212",position:"top-right"},source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css"}},isPhotoFigcaption:!0,islazyload:!1,isAnchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Django-Vue搭建个人博客(4)：前端功能完善",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-04-10 18:30:15"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const a=864e5*o,c={value:t,expiry:(new Date).getTime()+a};localStorage.setItem(e,JSON.stringify(c))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise(((t,o)=>{const a=document.createElement("script");a.src=e,a.async=!0,a.onerror=o,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)})),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme"),o=window.matchMedia("(prefers-color-scheme: dark)").matches,a=window.matchMedia("(prefers-color-scheme: light)").matches,c=window.matchMedia("(prefers-color-scheme: no-preference)").matches,n=!o&&!a&&!c;if(void 0===t){if(a)activateLightMode();else if(o)activateDarkMode();else if(c||n){const e=(new Date).getHours();e<=6||e>=18?activateDarkMode():activateLightMode()}window.matchMedia("(prefers-color-scheme: dark)").addListener((function(e){void 0===saveToLocal.get("theme")&&(e.matches?activateDarkMode():activateLightMode())}))}else"light"===t?activateLightMode():activateDarkMode();const i=saveToLocal.get("aside-status");void 0!==i&&("hide"===i?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><meta name="generator" content="Hexo 5.4.2"><style>.github-emoji{position:relative;display:inline-block;width:1.2em;min-height:1.2em;overflow:hidden;vertical-align:top;color:transparent}.github-emoji>span{position:relative;z-index:10}.github-emoji .fancybox,.github-emoji img{margin:0!important;padding:0!important;border:none!important;outline:0!important;text-decoration:none!important;user-select:none!important;cursor:auto!important}.github-emoji img{height:1.2em!important;width:1.2em!important;position:absolute!important;left:50%!important;top:50%!important;transform:translate(-50%,-50%)!important;user-select:none!important;cursor:auto!important}.github-emoji-fallback{color:inherit}.github-emoji-fallback img{opacity:0!important}</style></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/pics/avatar.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">18</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-graduation-cap"></i> <span>博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-archive"></i> <span>归档</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-folder-open"></i> <span>分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i> <span>标签</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i> <span>生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i> <span>相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i> <span>音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i> <span>影视</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fa fa-gamepad"></i> <span>游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">小邹同学</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-graduation-cap"></i> <span>博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-archive"></i> <span>归档</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-folder-open"></i> <span>分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i> <span>标签</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i> <span>生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i> <span>相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i> <span>音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i> <span>影视</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fa fa-gamepad"></i> <span>游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Django-Vue搭建个人博客(4)：前端功能完善</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-04-06T13:00:00.000Z" title="发表于 2023-04-06 21:00:00">2023-04-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-04-10T10:30:15.662Z" title="更新于 2023-04-10 18:30:15">2023-04-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Django-Vue/">Django &amp; Vue</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">17.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>93分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="1-准备工作">1. 准备工作</h2><h3 id="1-1-安装Axios">1.1 安装Axios</h3><p>虽然现在前后端 Django + Vue 都有了，但还缺一个它们之间通信的手段。Vue 官方推荐的是 <a target="_blank" rel="noopener" href="https://github.com/axios/axios">axios</a> 这个前端库。</p><p>命令行进入 <code>frontend</code> 目录，安装 axios</p><pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">&gt; npm install axios<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="1-2-解决跨域">1.2 解决跨域</h3><p>跨域问题是由于浏览器的同源策略（域名，协议，端口均相同）造成的，是浏览器施加的安全限制。即Vue 服务器端口（8080）和 Django 服务器端口（8000）不一致，因此无法通过 Javascript 代码请求后端资源。</p><p>解决跨域的方法有两种：</p><p>方法一（前端解决）：前端配置<code>fronted/vite.config.js</code>文件并写入：</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// frontend/vite.config.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> fileURLToPath<span class="token punctuation">,</span> <span class="token constant">URL</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'node:url'</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vite'</span>
<span class="token keyword">import</span> vue <span class="token keyword">from</span> <span class="token string">'@vitejs/plugin-vue'</span>

<span class="token comment">// https://vitejs.dev/config/</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">'@'</span><span class="token operator">:</span> <span class="token function">fileURLToPath</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">'./src'</span><span class="token punctuation">,</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">server</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token string">'5173'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">proxy</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">'/api'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">'http://127.0.0.1:8000/api'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">changeOrigin</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token function-variable function">rewrite</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> path<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\/api</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>方法二（后端解决）：后端引入<code>django-cors-middleware</code>库</p><p>两种解决方法都可以，这里选择前端代理的方法。</p><h2 id="2-Vue结构">2. Vue结构</h2><p>为了理解 Vue 的基本结构，让我们来看三个重要的文件。</p><h3 id="2-1-index-html">2.1 index.html</h3><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- frontend/index.html --&gt;</span> 

<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>icon<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/favicon.ico<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Vite App<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/src/main.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这个页面是整个前端工程提供 html 的入口，里面的 <code>&lt;div id="app"&gt;</code> 是 Vue 初始化应用程序的根容器。</p><p>不过在前端工程化的思想中，很少会直接去写这类 <code>html</code> 文件。</p><h3 id="2-2-main-js">2.2 main.js</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// frontend/src/main.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>

<span class="token keyword">import</span> <span class="token string">'./assets/main.css'</span>

<span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>作用是把后续你要写的 Vue 组件挂载到刚才那个 <code>index.html</code> 中。</p><p>如果你有些前端的初始化配置，都可以写到这里。</p><h3 id="2-3-App-vue">2.3 App.vue</h3><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/App.vue --&gt;

&lt;script setup&gt;
import HelloWorld from './components/HelloWorld.vue'
import TheWelcome from './components/TheWelcome.vue'
&lt;/script&gt;

&lt;template&gt;
  &lt;header&gt;
    &lt;img alt="Vue logo" class="logo" src="./assets/logo.svg" width="125" height="125" /&gt;

    &lt;div class="wrapper"&gt;
      &lt;HelloWorld msg="You did it!" /&gt;
    &lt;/div&gt;
  &lt;/header&gt;

  &lt;main&gt;
    &lt;TheWelcome /&gt;
  &lt;/main&gt;
&lt;/template&gt;

&lt;style scoped&gt;
header {
  line-height: 1.5;
}

.logo {
  display: block;
  margin: 0 auto 2rem;
}

@media (min-width: 1024px) {
  header {
    display: flex;
    place-items: center;
    padding-right: calc(var(--section-gap) / 2);
  }

  .logo {
    margin: 0 2rem 0 0;
  }

  header .wrapper {
    display: flex;
    place-items: flex-start;
    flex-wrap: wrap;
  }
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这个文件对应 Vue 的欢迎页面，</p><p>Vue 采用组件化的思想，把同一个组件的内容打包到一起。比如这个默认的 <code>App.vue</code> 文件， <code>&lt;template&gt;</code> 标签就对应传统的 <code>html</code> ，<code>&lt;script&gt;</code> 标签对应 <code>javascript</code> ，<code>&lt;style&gt;</code> 标签对应了 <code>css</code> 。</p><p><code>&lt;HelloWorld .../&gt;</code> 和<code>&lt;TheWelcome /&gt;</code>是封装好的组件，路径位于 <code>frontend/src/components/</code> 。</p><p>以上就是 Vue 项目三个重要的文件，而对入门者来说，最重要的就是各种 <code>.vue</code> 文件，这就是你最主要的写代码的地方。</p><h2 id="3-文章列表">3. 文章列表</h2><h3 id="3-1-初次尝试">3.1 初次尝试</h3><p>Vue 把同一个组件的 <code>template</code> / <code>script</code> / <code>style</code> 打包到一起组成<code>.vue</code>文件。在<code>App.vue</code>里编写文章列表页面代码：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/App.vue --&gt;

&lt;template&gt;
  &lt;div v-for="article in info.results" :key="article.url" id="articles"&gt;
    &lt;div class="article-title"&gt;
      {{ article.title }}
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import axios from 'axios'

export default {
  name: 'App',
  data() {
    return {
      info: ''
    }
  },
  mounted() {
    axios.get('/api/article').then(response =&gt; {
      this.info = response.data
    })
  }
}
&lt;/script&gt;

&lt;style&gt;
#articles {
  padding: 10px;
}

.article-title {
  font-size: large;
  font-weight: bolder;
  color: black;
  text-decoration: none;
  padding: 5px 0 5px 0;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>删除<code>main.js</code>中引入的样式，即删除<code>import './assets/main.css'</code>这一行内容。</p><p>访问地址：<a target="_blank" rel="noopener" href="http://localhost:5173/">http://localhost:5173/</a> 即可看到后端文章列表数据被渲染出来了。</p><p><img src="Django-Vue%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2(4)%EF%BC%9A%E5%89%8D%E7%AB%AF%E5%8A%9F%E8%83%BD%E5%AE%8C%E5%96%84/image-20230328201646275.png" alt="初次尝试"></p><h3 id="3-2-优化界面">3.2 优化界面</h3><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/App.vue --&gt;

&lt;template&gt;
  &lt;div v-for="article in info.results" :key="article.url" id="articles"&gt;
    &lt;div&gt;
      &lt;span v-for="tag in article.tags" :key="tag" class="tag"&gt;
        {{ tag }}
      &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class="article-title"&gt;
      {{ article.title }}
    &lt;/div&gt;
    &lt;div&gt;{{ formatted_time(article.created) }}&lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import axios from 'axios'

export default {
  name: 'App',
  data() {
    return {
      info: ''
    }
  },
  mounted() {
    axios.get('/api/article').then(response =&gt; {
      this.info = response.data
    })
  },
  methods: {
    formatted_time(iso_date_string) {
      const date = new Date(iso_date_string)
      return date.toLocaleDateString()
    }
  }
}
&lt;/script&gt;

&lt;style&gt;
#articles {
  padding: 10px;
}

.article-title {
  font-size: large;
  font-weight: bolder;
  color: black;
  text-decoration: none;
  padding: 5px 0 5px 0;
}

.tag {
  padding: 2px 5px 2px 5px;
  margin: 5px 5px 5px 0;
  font-family: Georgia, Arial, sans-serif;
  font-size: small;
  background-color: #4e4e4e;
  color: whitesmoke;
  border-radius: 5px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>现在博客页面大概是这样子的：</p><p><img src="Django-Vue%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2(4)%EF%BC%9A%E5%89%8D%E7%AB%AF%E5%8A%9F%E8%83%BD%E5%AE%8C%E5%96%84/image-20230328201737241.png" alt="image-20230328201737241"></p><h3 id="3-3-添加页眉页脚">3.3 添加页眉页脚</h3><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/App.vue --&gt;

&lt;template&gt;
  &lt;div id="header"&gt;
    &lt;h1&gt;My Django REST framework-Vue Blog&lt;/h1&gt;
    &lt;hr&gt;
  &lt;/div&gt;

  &lt;div v-for="article in info.results" :key="article.url" id="articles"&gt;
    &lt;div&gt;
      &lt;span v-for="tag in article.tags" :key="tag" class="tag"&gt;
        {{ tag }}
      &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class="article-title"&gt;
      {{ article.title }}
    &lt;/div&gt;
    &lt;div&gt;{{ formatted_time(article.created) }}&lt;/div&gt;
  &lt;/div&gt;

  &lt;div id="footer"&gt;
    &lt;p&gt;http://localhost:5173/&lt;/p&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import axios from 'axios'

export default {
  name: 'App',
  data() {
    return {
      info: ''
    }
  },
  mounted() {
    axios.get('/api/article').then(response =&gt; {
      this.info = response.data
    })
  },
  methods: {
    formatted_time(iso_date_string) {
      const date = new Date(iso_date_string)
      return date.toLocaleDateString()
    }
  }
}
&lt;/script&gt;

&lt;style&gt;
#app {
  font-family: Georgia, Arial, sans-serif;
  margin-left: 40px;
  margin-right: 40px;
}

#header {
  text-align: center;
  margin-top: 20px;
}

#footer {
  position: fixed;
  left: 0;
  bottom: 0;
  height: 50px;
  width: 100%;
  background: whitesmoke;
  text-align: center;
  font-weight: bold;
}

#articles {
  padding: 10px;
}

.article-title {
  font-size: large;
  font-weight: bolder;
  color: black;
  text-decoration: none;
  padding: 5px 0 5px 0;
}

.tag {
  padding: 2px 5px 2px 5px;
  margin: 5px 5px 5px 0;
  font-family: Georgia, Arial, sans-serif;
  font-size: small;
  background-color: #4e4e4e;
  color: whitesmoke;
  border-radius: 5px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>现在博客页面大概是这样子的：</p><p><img src="Django-Vue%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2(4)%EF%BC%9A%E5%89%8D%E7%AB%AF%E5%8A%9F%E8%83%BD%E5%AE%8C%E5%96%84/image-20230328203043454.png" alt="添加页眉页脚"></p><h3 id="3-4-组件化">3.4 组件化</h3><p>组件化是 Vue 的核心思想之一。组件可以把网页分解成一个个的小功能，达到代码解耦及复用。</p><p>在 <code>frontend/src/components/</code> 路径下分别创建 <code>ArticleList.vue</code> / <code>BlogHeader.vue</code> / <code>BlogFooter.vue</code> 三个文件，并且把我们之前在 <code>App.vue</code> 中写的代码分别搬运到对应的位置。</p><p>三个文件的内容如下（注意 <code>export</code> 中的 <code>name</code> 有对应的更改）：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/components/ArticleList.vue --&gt;

&lt;template&gt;
  &lt;div v-for="article in info.results" :key="article.url" id="articles"&gt;
    &lt;div&gt;
      &lt;span v-for="tag in article.tags" :key="tag" class="tag"&gt;
        {{ tag }}
      &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class="article-title"&gt;
      {{ article.title }}
    &lt;/div&gt;
    &lt;div&gt;{{ formatted_time(article.created) }}&lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import axios from 'axios'

export default {
  name: 'ArticleList',
  data() {
    return {
      info: ''
    }
  },
  mounted() {
    axios.get('/api/article').then(response =&gt; {
      this.info = response.data
    })
  },
  methods: {
    formatted_time(iso_date_string) {
      const date = new Date(iso_date_string)
      return date.toLocaleDateString()
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
#articles {
  padding: 10px;
}

.article-title {
  font-size: large;
  font-weight: bolder;
  color: black;
  text-decoration: none;
  padding: 5px 0 5px 0;
}

.tag {
  padding: 2px 5px 2px 5px;
  margin: 5px 5px 5px 0;
  font-family: Georgia, Arial, sans-serif;
  font-size: small;
  background-color: #4e4e4e;
  color: whitesmoke;
  border-radius: 5px;
}
&lt;/style&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/components/BlogHeader.vue --&gt;

&lt;template&gt;
  &lt;div id="header"&gt;
    &lt;h1&gt;My Django REST framework-Vue Blog&lt;/h1&gt;
    &lt;hr&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  name: 'BlogHeader'
}
&lt;/script&gt;

&lt;style scoped&gt;
#header {
  text-align: center;
  margin-top: 20px;
}
&lt;/style&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/components/BlogFooter.vue --&gt;

&lt;template&gt;
  &lt;div id="footer"&gt;
    &lt;p&gt;http://localhost:5173/&lt;/p&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  name: 'BlogFooter'
}
&lt;/script&gt;

&lt;style scoped&gt;
#footer {
  position: fixed;
  left: 0;
  bottom: 0;
  height: 50px;
  width: 100%;
  background: whitesmoke;
  text-align: center;
  font-weight: bold;
}
&lt;/style&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/App.vue --&gt;

&lt;template&gt;
  &lt;blog-header /&gt;
  &lt;article-list /&gt;
  &lt;blog-footer /&gt;
&lt;/template&gt;

&lt;script&gt;
import BlogHeader from '@/components/BlogHeader.vue'
import BlogFooter from '@/components/BlogFooter.vue'
import ArticleList from '@/components/ArticleList.vue'

export default {
  name: 'App',
  components: { BlogHeader, BlogFooter, ArticleList }
}
&lt;/script&gt;

&lt;style&gt;
#app {
  font-family: Georgia, Arial, sans-serif;
  margin-left: 40px;
  margin-right: 40px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>刷新页面，功能虽然与修改前完全相同，但代码变得更加规整。</p><h2 id="4-文章详情">4. 文章详情</h2><h3 id="4-1-优化文件结构">4.1 优化文件结构</h3><p>由于后续页面会越来越多，为了避免 <code>App.vue</code> 越发臃肿，因此必须优化文件结构。</p><p>新建 <code>frontend/src/views/</code> 目录，用来存放现在及将来所有的页面文件。在此目录新建 <code>Home.vue</code> 文件，把之前的首页代码稍加修改搬运过来：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/views/Home.vue --&gt;

&lt;template&gt;
  &lt;blog-header /&gt;
  &lt;article-list /&gt;
  &lt;blog-footer /&gt;
&lt;/template&gt;

&lt;script&gt;
import BlogHeader from '@/components/BlogHeader.vue'
import BlogFooter from '@/components/BlogFooter.vue'
import ArticleList from '@/components/ArticleList.vue'

export default {
  name: 'Home',
  components: { BlogHeader, BlogFooter, ArticleList }
}
&lt;/script&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>新增文章详情页面：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/views/ArticleDetail.vue --&gt;
&lt;template&gt;
  &lt;blog-header /&gt;

  &lt;blog-footer /&gt;
&lt;/template&gt;
  
&lt;script&gt;
import BlogHeader from '@/components/BlogHeader.vue'
import BlogFooter from '@/components/BlogFooter.vue'

export default {
  name: 'ArticleDetail',
  components: { BlogHeader, BlogFooter }
}
&lt;/script&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>修改 <code>App.vue</code>：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/App.vue --&gt;

&lt;template&gt;
  &lt;router-view /&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  name: 'App',
}
&lt;/script&gt;

&lt;style&gt;
#app {
  font-family: Georgia, Arial, sans-serif;
  margin-left: 40px;
  margin-right: 40px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>从列表到详情，需要解决页面跳转，采用<strong>前端路由</strong>的方式来实现页面跳转</p><h3 id="4-2-配置路由">4.2 配置路由</h3><p>执行<code>npm install vue-router</code>安装 Vue 的官方前端路由库<code>vue-router</code></p><p>因为 vue-router 会用到文章的 id 作为动态地址，所以修改 <strong>Django 后端</strong>文件<code>article/serializers.py</code>的<code>ArticleBaseSerializer</code>，添加一行 <code>id = serializers.IntegerField(read_only=True)</code> ，简单的把文章的 id 值增加到接口数据中。</p><p>新建 <code>frontend/src/router/index.js</code> 文件用于存放路由相关的文件，写入：</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// frontend/src/router/index.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> createRouter<span class="token punctuation">,</span> createWebHistory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span>

<span class="token keyword">const</span> <span class="token function-variable function">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/Home.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">ArticleDetail</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/ArticleDetail.vue'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> Home
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/article/:id'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'ArticleDetail'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> ArticleDetail
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">history</span><span class="token operator">:</span> <span class="token function">createWebHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  routes<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>列表 <code>routes</code> 定义了所有需要挂载到路由中的路径，成员为<strong>路径 url</strong> 、<strong>路径名</strong>和<strong>路径的 vue 对象</strong>。详情页面的动态路由采用冒号 <code>:id</code> 的形式来定义。</li><li>接着就用 <code>createRouter()</code> 创建 router。参数里的 <code>history</code> 定义具体的路由形式，<code>createWebHashHistory()</code> 为哈希模式（具体路径在 # 符号后面）；<code>createWebHistory()</code> 为 HTML5 模式（路径中没有丑陋的 # 符号），此为<strong>推荐模式</strong>，但是<strong>部署时需要额外的配置</strong>。</li></ul><blockquote><p><em>各模式的详细介绍看</em><a target="_blank" rel="noopener" href="https://router.vuejs.org/zh/guide/essentials/history-mode.html">文档</a><em>。</em></p></blockquote><p>将 vue-router 加载 Vue 实例中：</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// frontend/src/main.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>

<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./router'</span>

<span class="token keyword">let</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>此时，浏览器访问 <a target="_blank" rel="noopener" href="http://localhost:5173/">http://localhost:5173/</a> 得到 <strong>Home</strong> 页面</p><h3 id="4-3-文章详情页面">4.3 文章详情页面</h3><p>修改文章列表的组件代码</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/components/ArticleList.vue --&gt;

&lt;template&gt;
  &lt;div v-for="article in info.results" :key="article.url" id="articles"&gt;
    &lt;div&gt;
      &lt;span v-for="tag in article.tags" :key="tag" class="tag"&gt;
        {{ tag }}
      &lt;/span&gt; 
    &lt;/div&gt;
    &lt;router-link :to="{ name: 'ArticleDetail', params: { id: article.id } }" class="article-title"&gt;
      {{ article.title }}
    &lt;/router-link&gt;
    &lt;div&gt;{{ formatted_time(article.created) }}&lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import axios from 'axios'

export default {
  name: 'ArticleList',
  data() {
    return {
      info: ''
    }
  },
  mounted() {
    axios.get('/api/article').then(response =&gt; {
      this.info = response.data
    })
  },
  methods: {
    formatted_time(iso_date_string) {
      const date = new Date(iso_date_string)
      return date.toLocaleDateString()
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
#articles {
  padding: 10px;
}

.article-title {
  font-size: large;
  font-weight: bolder;
  color: black;
  text-decoration: none;
  padding: 5px 0 5px 0;
}

.tag {
  padding: 2px 5px 2px 5px;
  margin: 5px 5px 5px 0;
  font-family: Georgia, Arial, sans-serif;
  font-size: small;
  background-color: #4e4e4e;
  color: whitesmoke;
  border-radius: 5px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>调用 vue-router 不再需要常规的 <code>&lt;a&gt;</code> 标签，而是 <code>&lt;router-link&gt;</code> ，<code>:to</code> 属性指定了跳转位置，注意看<strong>动态参数 id</strong> 是如何传递的。</p><p>在 Vue 中，属性前面的冒号 <code>:</code> 表示此属性被”绑定“了。”绑定“的对象可以是某个动态的参数（比如这里的 id 值），也可以是 Vue 所管理的 data，也可以是 methods。冒号 <code>:</code> 实际上是 <code>v-bind:</code> 的缩写。</p><p>Router 骨架就搭建完毕了。此时点击首页的文章标题链接后，应该就顺利跳转到一个只有页眉页脚的详情页面了。</p><p>接下来编写详情页面：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/views/ArticleDetail.vue --&gt;

&lt;template&gt;
  &lt;blog-header /&gt;
  &lt;div v-if="article !== null" class="grid-container"&gt;
    &lt;div&gt;
      &lt;h1 id="title"&gt;{{ article.title }}&lt;/h1&gt;
      &lt;p id="subtitle"&gt;本文由 {{ article.author.username }} 发布于 {{ formatted_time(article.created) }}&lt;/p&gt;
      &lt;div v-html="article.body_html" class="article-body"&gt;&lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;h3&gt;目录&lt;/h3&gt;
      &lt;div v-html="article.toc_html" class="toc"&gt;&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;blog-footer /&gt;
&lt;/template&gt;
  
&lt;script&gt;
import BlogHeader from '@/components/BlogHeader.vue'
import BlogFooter from '@/components/BlogFooter.vue'
import axios from 'axios'

export default {
  name: 'ArticleDetail',
  components: { BlogHeader, BlogFooter },
  data() {
    return {
      article: null
    }
  },
  mounted() {
    axios.get('/api/article/' + this.$route.params.id).then(response =&gt; {
      this.article = response.data
    })
  },
  methods: {
    formatted_time(iso_date_string) {
      const date = new Date(iso_date_string)
      return date.toLocaleDateString()
    }
  }
}
&lt;/script&gt;
  
&lt;style scoped&gt;
.grid-container {
  display: grid;
  grid-template-columns: 3fr 1fr;
}

#title {
  text-align: center;
  font-size: x-large;
}

#subtitle {
  text-align: center;
  color: gray;
  font-size: small;
}
&lt;/style&gt;


&lt;style&gt;
.article-body p img {
  max-width: 100%;
  border-radius: 50px;
  box-shadow: gray 0 0 20px;
}

.toc ul {
  list-style-type: none;
}

.toc a {
  color: gray;
}
&lt;/style&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>模板 - template</strong>部分：</p><ul><li>在渲染文章前，逻辑控制语句 <code>v-if</code> 先确认数据是否存在，避免出现<strong>潜在的</strong>调用数据不存在的 bug。</li><li>由于 <code>body_html</code> 、<code>toc_html</code> 都是后端渲染好的 markdown 文本，需要将其直接转换为 HTML ，所以需要用 <code>v-html</code> 标注。</li></ul><p><strong>脚本 - script</strong>部分：</p><ul><li>通过 <code>$route.params.id</code> 可以获得路由中的动态参数，以此拼接为接口向后端请求数据。</li></ul><p><strong>样式 - style</strong>部分：</p><ul><li><code>.grid-container</code> 简单的给文章内容、目录划分了网格区域。</li><li><code>&lt;style&gt;</code> 标签可以有多个，满足“分块强迫症患者”的需求。这里分两个的原因是文章内容、目录都是从原始 HTML 渲染的，不在 <code>scoped</code> 的管理范围内。</li></ul><h2 id="5-翻页与监听">5. 翻页与监听</h2><h3 id="5-1-路由与查询参数">5.1 路由与查询参数</h3><p>详情页面跳转，用到了 vue-router 动态匹配路由的能力。而翻页功能通常不会直接改变当前路由，而是修改 url 中的查询参数来实现。区别如下：</p><pre class="line-numbers language-none"><code class="language-none"># 改变路由
https://abc.com/2
# 改变查询参数
http://abc.com/?page=2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-2-实现翻页">5.2 实现翻页</h3><blockquote><p>翻页在 <code>ArticleList.vue</code> 中完成</p></blockquote><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/components/ArticleList.vue --&gt;

&lt;template&gt;
  &lt;div v-for="article in info.results" :key="article.url" id="articles"&gt;
    &lt;div&gt;
      &lt;span v-for="tag in article.tags" :key="tag" class="tag"&gt;
        {{ tag }}
      &lt;/span&gt;
    &lt;/div&gt;
    &lt;router-link :to="{ name: 'ArticleDetail', params: { id: article.id } }" class="article-title"&gt;
      {{ article.title }}
    &lt;/router-link&gt;
    &lt;div&gt;{{ formatted_time(article.created) }}&lt;/div&gt;
  &lt;/div&gt;
  &lt;div id="paginator"&gt;
    &lt;span v-if="is_page_exists('previous')"&gt;
      &lt;router-link :to="{ name: 'Home', query: { page: get_page_param('previous') } }"&gt;
        Prev
      &lt;/router-link&gt;
    &lt;/span&gt;
    &lt;span class="current-page"&gt;
      {{ get_page_param('current') }}
    &lt;/span&gt;
    &lt;span v-if="is_page_exists('next')"&gt;
      &lt;router-link :to="{ name: 'Home', query: { page: get_page_param('next') } }"&gt;
        Next
      &lt;/router-link&gt;
    &lt;/span&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import axios from 'axios'

export default {
  name: 'ArticleList',
  data() {
    return {
      info: '',
    }
  },
  mounted() {
    this.get_article_data()
  },
  methods: {
    // 判断页面是否存在
    is_page_exists(direction) {
      if (direction === 'next') {
        return this.info.next !== null
      }
      return this.info.previous !== null
    },
    // 获取页码
    get_page_param(direction) {
      try {
        let url_string
        switch (direction) {
          case 'next':
            url_string = this.info.next
            break
          case 'previous':
            url_string = this.info.previous
            break
          default:
            if (!('page' in this.$route.query)) {
              return 1
            }
            if (this.$route.query.page === null) {
              return 1
            }
            return this.$route.query.page
        }
        const url = new URL(url_string)
        return url.searchParams.get('page')
      } catch (err) {
        return
      }
    },
    // 获取文章列表数据
    get_article_data() {
      let url = '/api/article/'
      const page = Number(this.$route.query.page)
      if (!isNaN(page) &amp;&amp; (page !== 0)) {
        url = url + '?page=' + page
      }
      axios.get(url).then(response =&gt; {
        this.info = response.data
      }).catch(error =&gt; {
        console.log(error)
      })
    },
  },
  watch: {
    // 监听路由变化
    $route() {
      this.get_article_data()
    }
  },
  computed: {
    // 格式化时间
    formatted_time() {
      return timeString =&gt; new Date(timeString).toLocaleDateString()
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
#articles {
  padding: 10px;
}

.article-title {
  font-size: large;
  font-weight: bolder;
  color: black;
  text-decoration: none;
  padding: 5px 0 5px 0;
}

.tag {
  padding: 2px 5px 2px 5px;
  margin: 5px 5px 5px 0;
  font-family: Georgia, Arial, sans-serif;
  font-size: small;
  background-color: #4e4e4e;
  color: whitesmoke;
  border-radius: 5px;
}

#paginator {
  text-align: center;
  padding-top: 50px;
}

a {
  color: black;
}

.current-page {
  font-size: x-large;
  font-weight: bold;
  padding-left: 10px;
  padding-right: 10px;
}
&lt;/style&gt;

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>is_page_exists(...)</code> 用于确认需要跳转的页面是否存在，如果不存在那就不渲染对应的跳转标签。它的唯一参数用于确定页面的方向（当前页、上一页或下一页）。</li><li><code>get_page_param(...)</code> 用于获取页码。</li><li><code>router-link</code> 通过 query 传递参数</li><li><code>try</code> 是为了避免潜在的取值问题（比如网速缓慢时 <code>info</code> 还未获取到数据）， <code>catch</code> 语句向控制台打印报错。</li><li><code>switch</code> 用来控制翻页方向，它默认查询了当前的页码，用于显示。</li><li><code>watch</code> 的作用是监听路由的变化，一旦发生变化则立即根据当前页码更新对应的文章数据。</li><li><code>computed</code> 用来格式化时间，与<code>methods</code>不同之处在于，<strong>competed</strong> 有缓存，在值不变的情况下不会再次计算，而是直接使用缓存中的值。</li></ul><h2 id="6-搜索文章">6. 搜索文章</h2><h3 id="6-1-实现输入框">6.1 实现输入框</h3><p>将搜索框放在页眉，这样用户在博客的所有页面都能找到搜索框。修改<code>BlogHeader.vue</code>：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/components/BlogHeader.vue --&gt;

&lt;template&gt;
  &lt;div id="header"&gt;
    &lt;div class="grid"&gt;
      &lt;div&gt;&lt;/div&gt;
      &lt;h1&gt;My Django REST framework-Vue Blog&lt;/h1&gt;
      &lt;div class="search"&gt;
        &lt;form&gt;
          &lt;input v-model="searchText" type="text" placeholder="输入搜索内容..."&gt;
          &lt;button @click.prevent="searchArticle"&gt;&lt;/button&gt;
        &lt;/form&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;hr&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  name: 'BlogHeader',
  data() {
    return {
      searchText: ''
    }
  },
  methods: {
    searchArticle() {
      const text = this.searchText.trim()
      if (text.charAt(0) !== '') {
        this.$router.push({ name: 'Home', query: { search: text } })
      }
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
#header {
  text-align: center;
  margin-top: 20px;
}

.grid {
  display: grid;
  grid-template-columns: 1fr 4fr 1fr;
}

.search {
  padding-top: 22px;
}

* {
  box-sizing: border-box;
}

form {
  position: relative;
  width: 200px;
  margin: 0 auto;
}

input,
button {
  border: none;
  outline: none;
}

input {
  width: 100%;
  height: 35px;
  padding-left: 13px;
  padding-right: 46px;
}

button {
  height: 35px;
  width: 35px;
  cursor: pointer;
  position: absolute;
}

.search input {
  border: 2px solid gray;
  border-radius: 5px;
  background: transparent;
  top: 0;
  right: 0;
}

.search button {
  background: gray;
  border-radius: 0 5px 5px 0;
  width: 45px;
  top: 0;
  right: 0;
}

.search button:before {
  content: "搜索";
  font-size: 13px;
  color: white;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>v-model</code> 指令可以在表单控件上创建<strong>双向数据绑定</strong>。具体来说，就是上面的 <code>&lt;input&gt;</code> 中的数据和 Vue 管理的 <code>searchText</code> 数据绑定在一起了，其中一个发生变化，另一个也会改变。</li><li><code>@click</code> 绑定了按钮的<strong>鼠标点击事件</strong>，即点击则触发 <code>searchArticles()</code> 方法。<code>.prevent</code> 用于阻止按钮原本的表单提交功能。</li><li><code>&lt;router-link&gt;</code> 标签实现路由跳转。在必要时候也可以通过脚本来<strong>动态实现</strong>路由跳转，即 <code>this.$router.push(...)</code> 。注意 <code>this.$route</code> 和 <code>this.$router</code> ，前者代表路径对象，后者代表路由器对象。</li></ul><h3 id="6-2-实现搜索">6.2 实现搜索</h3><p>在 <code>ArticleList.vue</code> 里进行修改（主要是 Javascript 部分）。</p><p>旧的翻页 <code>&lt;router-link&gt;</code> 仅考虑了路径参数中的 <code>page</code> 值。为了在翻页后取得包括 <code>page</code> 和 <code>search</code> 的正确路径，新写一个方法 <code>get_path()</code>：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/components/ArticleList.vue --&gt;

&lt;template&gt;
  &lt;div v-for="article in info.results" :key="article.url" id="articles"&gt;
    &lt;div&gt;
      &lt;span v-for="tag in article.tags" :key="tag" class="tag"&gt;
        {{ tag }}
      &lt;/span&gt;
    &lt;/div&gt;
    &lt;router-link :to="{ name: 'ArticleDetail', params: { id: article.id } }" class="article-title"&gt;
      {{ article.title }}
    &lt;/router-link&gt;
    &lt;div&gt;{{ formatted_time(article.created) }}&lt;/div&gt;
  &lt;/div&gt;
  &lt;div id="paginator"&gt;
    &lt;span v-if="is_page_exists('previous')"&gt;
      &lt;router-link :to="get_path('previous')"&gt;
        Prev
      &lt;/router-link&gt;
    &lt;/span&gt;
    &lt;span class="current-page"&gt;
      {{ get_page_param('current') }}
    &lt;/span&gt;
    &lt;span v-if="is_page_exists('next')"&gt;
      &lt;router-link :to="get_path('next')"&gt;
        Next
      &lt;/router-link&gt;
    &lt;/span&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import axios from 'axios'

export default {
  name: 'ArticleList',
  data() {
    return {
      info: '',
    }
  },
  mounted() {
    this.get_article_data()
  },
  methods: {
    // 判断页面是否存在
    is_page_exists(direction) {
      if (direction === 'next') {
        return this.info.next !== null
      }
      return this.info.previous !== null
    },
    // 获取页码
    get_page_param(direction) {
      try {
        let url_string
        switch (direction) {
          case 'next':
            url_string = this.info.next
            break
          case 'previous':
            url_string = this.info.previous
            break
          default:
            if (!('page' in this.$route.query)) {
              return 1
            }
            if (this.$route.query.page === null) {
              return 1
            }
            return this.$route.query.page
        }
        const url = new URL(url_string)
        return url.searchParams.get('page')
      } catch (err) {
        return
      }
    },
    // 获取文章列表数据
    get_article_data() {
      let url = '/api/article/'
      let params = new URLSearchParams()
      if (this.isExists(this.$route.query.page)) {
        params.append('page', this.$route.query.page)
      }
      if (this.isExists(this.$route.query.search)) {
        params.append('search', this.$route.query.search)
      }
      const paramsString = params.toString()
      if (paramsString.charAt(0) !== '') {
        url += '/?' + paramsString
      }
      axios.get(url).then(response =&gt; {
        this.info = response.data
      }).catch(error =&gt; {
        console.log(error)
      })
    },
    // 获取路径
    get_path(direction) {
      let url = ''
      try {
        switch (direction) {
          case 'next':
            if (this.info.next !== undefined) {
              url += (new URL(this.info.next)).search
            }
            break
          case 'previous':
            if (this.info.previous !== undefined) {
              url += (new URL(this.info.previous)).search
            }
            break
        }
      } catch {
        return url
      }
      return url
    },
    // 检查参数是否存在
    isExists(value) {
      return value !== null &amp;&amp; value !== undefined
    }
  },
  watch: {
    // 监听路由变化
    $route() {
      this.get_article_data()
    }
  },
  computed: {
    // 格式化时间
    formatted_time() {
      return timeString =&gt; new Date(timeString).toLocaleDateString()
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
#articles {
  padding: 10px;
}

.article-title {
  font-size: large;
  font-weight: bolder;
  color: black;
  text-decoration: none;
  padding: 5px 0 5px 0;
}

.tag {
  padding: 2px 5px 2px 5px;
  margin: 5px 5px 5px 0;
  font-family: Georgia, Arial, sans-serif;
  font-size: small;
  background-color: #4e4e4e;
  color: whitesmoke;
  border-radius: 5px;
}

#paginator {
  text-align: center;
  padding-top: 50px;
}

a {
  color: black;
}

.current-page {
  font-size: x-large;
  font-weight: bold;
  padding-left: 10px;
  padding-right: 10px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>用于处理路径参数的 <code>URLSearchParams()</code> 对象。为了将路径中已有的参数添加到 <code>URLSearchParams()</code> 中，编写isExists方法<strong>判断值是否存在</strong>，然后用 <code>append()</code> 方法添加到路径。</p><h2 id="7-用户注册">7. 用户注册</h2><p>前面都是实现文章的 GET 请求，接下来实现更新、删除之类的请求，从用户管理入手。</p><h3 id="7-1-注册页面">7.1 注册页面</h3><p>新建 <code>frontend/src/views/Login.vue</code> 文件作为用户注册（以及登录）的页面：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/views/Login.vue --&gt;

&lt;template&gt;
  &lt;blog-header /&gt;

  &lt;div id="grid"&gt;
    &lt;div id="signup"&gt;
      &lt;h3&gt;注册账号&lt;/h3&gt;
      &lt;form&gt;
        &lt;div class="form-elem"&gt;
          &lt;span class="label"&gt;账号：&lt;/span&gt;
          &lt;input type="text" v-model="signupName" placeholder="输入用户名"&gt;
        &lt;/div&gt;
        &lt;div class="form-elem"&gt;
          &lt;span class="label"&gt;密码：&lt;/span&gt;
          &lt;input type="password" v-model="signupPwd" placeholder="输入密码"&gt;
        &lt;/div&gt;
        &lt;div class="form-elem"&gt;
          &lt;span class="label"&gt;确认密码：&lt;/span&gt;
          &lt;input type="password" v-model="signupPwdConfirm" placeholder="再次输入密码"&gt;
        &lt;/div&gt;
        &lt;div class="form-elem"&gt;
          &lt;button @click.prevent="signup"&gt;提交&lt;/button&gt;
        &lt;/div&gt;
      &lt;/form&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;blog-footer /&gt;
&lt;/template&gt;



&lt;script&gt;
import axios from 'axios'
import BlogHeader from '@/components/BlogHeader.vue';
import BlogFooter from '@/components/BlogFooter.vue';

export default {
  name: "Login",
  components: { BlogHeader, BlogFooter },
  data() {
    return {
      signupName: '',
      signupPwd: '',
      signupPwdConfirm: '',
      signupResponse: null,
    }
  },
  methods: {
    signup() {
      if (this.signupPwd !== this.signupPwdConfirm) {
        alert("两次密码不一致，请重新输入!")
        return
      }
      axios.post('/api/user/', {
        username: this.signupName,
        password: this.signupPwd,
      }).then((response) =&gt; {
        this.signupResponse = response.data
        alert('用户注册成功')
      }).catch((error) =&gt; {
        alert('用户注册失败:', error.message)
      })
    }
  }
}

&lt;/script&gt;

&lt;style scoped&gt;
#grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
}

#signup {
  text-align: center;
}

.form-elem {
  padding: 10px;
}

.label {
  display: inline-block;
  width: 80px;
  text-align: justify;
  text-align-last: justify;
  margin-right: 1px;
}

input {
  height: 25px;
  padding-left: 10px;
}

button {
  height: 35px;
  cursor: pointer;
  border: none;
  outline: none;
  background: gray;
  color: whitesmoke;
  border-radius: 5px;
  width: 60px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>上面代码的功能是将表单中的用户名和密码 <code>post</code> 到 <code>/api/user/</code> 接口，若创建成功则提醒用户前往登录，失败则将提示信息显示出来。</p><h3 id="7-2-注册路由">7.2 注册路由</h3><p>在<code>frontend/src/router/index.js</code>中添加注册路由</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// frontend/src/router/index.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> createRouter<span class="token punctuation">,</span> createWebHistory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span>

<span class="token keyword">const</span> <span class="token function-variable function">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/Home.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">ArticleDetail</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/ArticleDetail.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">Login</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/Login.vue'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> Home
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/article/:id'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'ArticleDetail'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> ArticleDetail
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/login'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Login'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> Login
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">history</span><span class="token operator">:</span> <span class="token function">createWebHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  routes<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在<code>frontend/src/components/BlogHeader.vue</code>添加入口：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/components/BlogHeader.vue --&gt;

&lt;template&gt;
  &lt;div id="header"&gt;
    &lt;div class="grid"&gt;
      &lt;div&gt;&lt;/div&gt;
      &lt;h1&gt;My Django REST framework-Vue Blog&lt;/h1&gt;
      &lt;div class="search"&gt;
        &lt;form&gt;
          &lt;input v-model="searchText" type="text" placeholder="输入搜索内容..."&gt;
          &lt;button @click.prevent="searchArticle"&gt;&lt;/button&gt;
        &lt;/form&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;hr&gt;
    &lt;div class="login"&gt;
      &lt;router-link to="/login" class="login-link"&gt;登录&lt;/router-link&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  name: 'BlogHeader',
  data() {
    return {
      searchText: ''
    }
  },
  methods: {
    searchArticle() {
      const text = this.searchText.trim()
      if (text.charAt(0) !== '') {
        this.$router.push({ name: 'Home', query: { search: text } })
      }
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
#header {
  text-align: center;
  margin-top: 20px;
}

.grid {
  display: grid;
  grid-template-columns: 1fr 4fr 1fr;
}

.search {
  padding-top: 22px;
}

* {
  box-sizing: border-box;
}

form {
  position: relative;
  width: 200px;
  margin: 0 auto;
}

input,
button {
  border: none;
  outline: none;
}

input {
  width: 100%;
  height: 35px;
  padding-left: 13px;
  padding-right: 46px;
}

button {
  height: 35px;
  width: 35px;
  cursor: pointer;
  position: absolute;
}

.search input {
  border: 2px solid gray;
  border-radius: 5px;
  background: transparent;
  top: 0;
  right: 0;
}

.search button {
  background: gray;
  border-radius: 0 5px 5px 0;
  width: 45px;
  top: 0;
  right: 0;
}

.search botton:before {
  content: "搜索";
  font-size: 13px;
  color: white;
}

.login {
  text-align: right;
  padding-right: 5px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="8-用户登录">8. 用户登录</h2><p>由于后端的认证方式为 JWT 认证，即后端返回给前端一个 token，前端在请求的 Header 中附带此 token 令牌来证明身份。<strong>token 保存在前端的什么地方？</strong></p><p>本教程将采用 token 保存在 <code>localStorage</code> 中，实现登录功能。</p><blockquote><p><em>此问题有广泛的讨论，因为 token 无论是保存在 localStorage、sessionStorage 或者 cookie 中均存在某些情况下被盗取的可能。网络安全不是本教程重点关注的问题，因此为了入门平滑将 token 保存于 localStorage 中，更深入的对安全的讨论请见</em> <a target="_blank" rel="noopener" href="https://hasura.io/blog/best-practices-of-using-jwt-with-graphql/">HASURA</a><em>、</em><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/Document/cookie">MDN</a><em>以及</em><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/26340275/where-to-save-a-jwt-in-a-browser-based-application-and-how-to-use-it">Stackoverflow</a><em>。有关 localStorage 的入门讲解</em><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/localStorage">看这里</a><em>。</em></p></blockquote><h3 id="8-1-登录页面">8.1 登录页面</h3><p>在 <code>Login.vue</code> 添加登录的表单的代码</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/views/Login.vue --&gt;

&lt;template&gt;
  &lt;blog-header /&gt;

  &lt;div id="grid"&gt;
    &lt;div id="signup"&gt;
      &lt;h3&gt;注册账号&lt;/h3&gt;
      &lt;form&gt;
        &lt;div class="form-elem"&gt;
          &lt;span class="label"&gt;账号：&lt;/span&gt;
          &lt;input type="text" v-model="signupName" placeholder="输入用户名"&gt;
        &lt;/div&gt;
        &lt;div class="form-elem"&gt;
          &lt;span class="label"&gt;密码：&lt;/span&gt;
          &lt;input type="password" v-model="signupPwd" placeholder="输入密码"&gt;
        &lt;/div&gt;
        &lt;div class="form-elem"&gt;
          &lt;span class="label"&gt;确认密码：&lt;/span&gt;
          &lt;input type="password" v-model="signupPwdConfirm" placeholder="再次输入密码"&gt;
        &lt;/div&gt;
        &lt;div class="form-elem"&gt;
          &lt;button @click.prevent="signup"&gt;提交&lt;/button&gt;
        &lt;/div&gt;
      &lt;/form&gt;
    &lt;/div&gt;
    &lt;div id="signin"&gt;
      &lt;h3&gt;登录账号&lt;/h3&gt;
      &lt;form&gt;
        &lt;div class="form-elem"&gt;
          &lt;span class="label"&gt;账号：&lt;/span&gt;
          &lt;input type="text" v-model="signinName" placeholder="输入用户名"&gt;
        &lt;/div&gt;
        &lt;div class="form-elem"&gt;
          &lt;span class="label"&gt;密码：&lt;/span&gt;
          &lt;input type="password" v-model="signinPwd" placeholder="输入密码"&gt;
        &lt;/div&gt;
        &lt;div class="form-elem"&gt;
          &lt;button @click.prevent="signin"&gt;登录&lt;/button&gt;
        &lt;/div&gt;
      &lt;/form&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;blog-footer /&gt;
&lt;/template&gt;


&lt;script&gt;
import axios from 'axios'
import BlogHeader from '@/components/BlogHeader.vue';
import BlogFooter from '@/components/BlogFooter.vue';

export default {
  name: "Login",
  components: { BlogHeader, BlogFooter },
  data() {
    return {
      signupName: '',
      signupPwd: '',
      signupPwdConfirm: '',
      signinName: '',
      signinPwd: '',
      signupResponse: null,
    }
  },
  methods: {
    signup() {
      if (this.signupPwd !== this.signupPwdConfirm) {
        alert("两次密码不一致，请重新输入!")
        return
      }
      axios.post('/api/user/', {
        username: this.signupName,
        password: this.signupPwd,
      }).then((response) =&gt; {
        this.signupResponse = response.data
        alert('用户注册成功')
      }).catch((error) =&gt; {
        alert('用户注册失败:', error.message)
      })
    },
    signin() {
      axios.post('/api/token/', {
        username: this.signinName,
        password: this.signinPwd,
      }).then((response) =&gt; {
        const storage = localStorage
        const expiredTime = Date.parse(response.headers.date) + 10800000
        storage.setItem('access.myblog', response.data.access)
        storage.setItem('refresh.myblog', response.data.refresh)
        storage.setItem('expiredTime.myblog', expiredTime)
        storage.setItem('username.myblog', this.signinName)
        this.$router.push({ name: 'Home' })
      }).catch((error) =&gt; {
        alert('用户登录失败:', error.message)
      })
    }
  }
}

&lt;/script&gt;

&lt;style scoped&gt;
#grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
}

#signup {
  text-align: center;
}

#signin {
  text-align: center;
}

.form-elem {
  padding: 10px;
}

.label {
  display: inline-block;
  width: 80px;
  text-align: justify;
  text-align-last: justify;
  margin-right: 1px;
}

input {
  height: 25px;
  padding-left: 10px;
}

button {
  height: 35px;
  cursor: pointer;
  border: none;
  outline: none;
  background: gray;
  color: whitesmoke;
  border-radius: 5px;
  width: 60px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="8-2-显示登录状态">8.2 显示登录状态</h3><p>修改<code>frontend/src/components/Blogheader.vue</code>：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/components/Blogheader.vue --&gt;

&lt;template&gt;
  &lt;div id="header"&gt;
    &lt;div class="grid"&gt;
      &lt;div&gt;&lt;/div&gt;
      &lt;h1&gt;My Django REST framework-Vue Blog&lt;/h1&gt;
      &lt;div class="search"&gt;
        &lt;form&gt;
          &lt;input v-model="searchText" type="text" placeholder="输入搜索内容..."&gt;
          &lt;button @click.prevent="searchArticle"&gt;&lt;/button&gt;
        &lt;/form&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;hr&gt;
    &lt;div class="login"&gt;
      &lt;div v-if="hasLogin"&gt;欢迎，{{ username }}&lt;/div&gt;
      &lt;div v-else&gt;
        &lt;router-link to="/login" class="login-link"&gt;登录&lt;/router-link&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import axios from 'axios'

export default {
  name: 'BlogHeader',
  data() {
    return {
      searchText: '',
      username: '',
      hasLogin: false,
    }
  },
  methods: {
    searchArticle() {
      const text = this.searchText.trim()
      if (text.charAt(0) !== '') {
        this.$router.push({ name: 'Home', query: { search: text } })
      }
    }
  },
  mounted() {
    const storage = localStorage
    const expiredTime = Number(storage.getItem('expiredTime.myblog'))
    const current = (new Date()).getTime()
    const refreshToken = storage.getItem('refresh.myblog')
    this.username = storage.getItem('username.myblog')

    if (expiredTime &gt; current) {
      this.hasLogin = true
    } else if (refreshToken !== null) {
      axios.post('/api/token/refresh/', { refresh: refreshToken }).then((response) =&gt; {
        const nextExpiredTime = Date.parse(response.headers.date) + 10800000
        storage.setItem('access.myblog', response.data.access)
        storage.setItem('expiredTime.myblog', nextExpiredTime)

        this.hasLogin = true
      }).catch(() =&gt; {
        storage.clear()
        this.hasLogin = false
        alert('请重新登录')
      })
    } else {
      storage.clear()
      this.hasLogin = false
      alert('请重新登录')
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
#header {
  text-align: center;
  margin-top: 20px;
}

.grid {
  display: grid;
  grid-template-columns: 1fr 4fr 1fr;
}

.search {
  padding-top: 22px;
}

* {
  box-sizing: border-box;
}

form {
  position: relative;
  width: 200px;
  margin: 0 auto;
}

input,
button {
  border: none;
  outline: none;
}

input {
  width: 100%;
  height: 35px;
  padding-left: 13px;
  padding-right: 46px;
}

button {
  height: 35px;
  width: 35px;
  cursor: pointer;
  position: absolute;
}

.search input {
  border: 2px solid gray;
  border-radius: 5px;
  background: transparent;
  top: 0;
  right: 0;
}

.search button {
  background: gray;
  border-radius: 0 5px 5px 0;
  width: 45px;
  top: 0;
  right: 0;
}

.search button:before {
  content: "搜索";
  font-size: 13px;
  color: white;
}

.login {
  text-align: right;
  padding-right: 5px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="9-用户资料">9 用户资料</h2><h3 id="9-1-搜索框组件化">9.1 搜索框组件化</h3><p>把搜索框组件化，新建一个<code>SearchButton.vue</code>文件，把<code>BlogHeader.vue</code>中与搜索相关的内容全部搬运过来。</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/components/SearchButton.vue --&gt;

&lt;template&gt;
  &lt;div class="search"&gt;
    &lt;form&gt;
      &lt;input type="text" v-model="searchText" placeholder="输入搜索内容..."&gt;
      &lt;button @click.prevent="searchArticle"&gt;&lt;/button&gt;
    &lt;/form&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  name: 'SearchButton',
  data() {
    return {
      searchText: '',
    }
  },
  methods: {
    searchArticle() {
      const text = this.searchText.trim()
      if (text.charAt(0) !== '') {
        this.$router.push({ name: 'Home', query: { search: text } })
      } else {
        this.$router.push({ name: 'Home' })
      }
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
.search {
  padding-top: 22px;
}

* {
  box-sizing: border-box;
}

form {
  position: relative;
  width: 200px;
  margin: 0 auto;
}

input,
button {
  border: none;
  outline: none;
}

input {
  width: 100%;
  height: 35px;
  padding-left: 13px;
  padding-right: 46px;
}

button {
  height: 35px;
  width: 35px;
  cursor: pointer;
  position: absolute;
}

.search input {
  border: 2px solid gray;
  border-radius: 5px;
  background: transparent;
  top: 0;
  right: 0;
}

.search button {
  background: gray;
  border-radius: 0 5px 5px 0;
  width: 45px;
  top: 0;
  right: 0;
}

.search button:before {
  content: "搜索";
  font-size: 13px;
  color: white;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>把<code>BlogHeader.vue</code>对应搜索的部分删除：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/components/BlogHeader.vue --&gt;

&lt;template&gt;
  &lt;div id="header"&gt;
    &lt;div class="grid"&gt;
      &lt;div&gt;&lt;/div&gt;
      &lt;h1&gt;My Django REST framework-Vue Blog&lt;/h1&gt;
      &lt;search-button /&gt;
    &lt;/div&gt;
    &lt;hr&gt;
    &lt;div class="login"&gt;
      &lt;div v-if="hasLogin"&gt;欢迎，{{ username }}&lt;/div&gt;
      &lt;div v-else&gt;
        &lt;router-link to="/login" class="login-link"&gt;登录&lt;/router-link&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import axios from 'axios'
import SearchButton from '@/components/SearchButton.vue'

export default {
  name: 'BlogHeader',
  data() {
    return {
      searchText: '',
      username: '',
      hasLogin: false,
    }
  },
  components: {
    SearchButton
  },
  methods: {

  },
  mounted() {
    const storage = localStorage
    const expiredTime = Number(storage.getItem('expiredTime.myblog'))
    const current = (new Date()).getTime()
    const refreshToken = storage.getItem('refresh.myblog')
    this.username = storage.getItem('username.myblog')

    if (expiredTime &gt; current) {
      this.hasLogin = true
    } else if (refreshToken !== null) {
      axios.post('/api/token/refresh/', { refresh: refreshToken }).then((response) =&gt; {
        const nextExpiredTime = Date.parse(response.headers.date) + 10800000
        storage.setItem('access.myblog', response.data.access)
        storage.setItem('expiredTime.myblog', nextExpiredTime)

        this.hasLogin = true
      }).catch(() =&gt; {
        storage.clear()
        this.hasLogin = false
        alert('请重新登录')
      })
    } else {
      storage.clear()
      this.hasLogin = false
      alert('请重新登录')
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
#header {
  text-align: center;
  margin-top: 20px;
}

.grid {
  display: grid;
  grid-template-columns: 1fr 4fr 1fr;
}

.login {
  text-align: right;
  padding-right: 5px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="9-2-异步和重构">9.2 异步和重构</h3><ul><li>用户资料页面涉及 POST/PATCH 等操作，需要验证用户的身份和 token 有效性；前面写的 <code>BlogHeader.vue</code> 也有类似的需求。因此需要将<strong>验证代码</strong>重构为一个单独的函数。</li><li>把<strong>验证代码</strong>抽象为单独的函数后，由于 <code>axios</code> 发送的请求是异步的，所以要将此处的异步代码转换为同步代码，否则 localStorage 的存取顺序会因为网速的快慢而不可预测，带来潜在 bug。</li></ul><p>新建路径和文件<code>frontend/src/utils/authorization.js</code>：</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// frontend/src/utils/authorization.js</span>

<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">authorization</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> storage <span class="token operator">=</span> localStorage
  <span class="token keyword">let</span> hasLogin <span class="token operator">=</span> <span class="token boolean">false</span>
  <span class="token keyword">let</span> username <span class="token operator">=</span> storage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'username.myblog'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> expiredTime <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>storage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'expiredTime.myblog'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> current <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> refreshToken <span class="token operator">=</span> storage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'refresh.myblog'</span><span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>expiredTime <span class="token operator">&gt;</span> current<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    hasLogin <span class="token operator">=</span> <span class="token boolean">true</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'authorization access'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>refreshToken <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'/api/token/refresh/'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">refresh</span><span class="token operator">:</span> refreshToken <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> nextExpiredTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>date<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">10800000</span>
      storage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'access.myblog'</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>access<span class="token punctuation">)</span>
      storage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'expiredTime.myblog'</span><span class="token punctuation">,</span> nextExpiredTime<span class="token punctuation">)</span>
      hasLogin <span class="token operator">=</span> <span class="token boolean">true</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'authorization refresh'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      storage<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      hasLogin <span class="token operator">=</span> <span class="token boolean">false</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'authorization err'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    storage<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    hasLogin <span class="token operator">=</span> <span class="token boolean">false</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'authorization exp'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'authorization done'</span><span class="token punctuation">)</span>
  
  <span class="token keyword">return</span> <span class="token punctuation">[</span>hasLogin<span class="token punctuation">,</span> username<span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> authorization
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>async/await</code> ： <code>async</code> 表示函数里含有异步操作，<code>await</code> 表示紧跟在后面的表达式需要等待结果。<code>await</code> 关键字只能用在 <code>async</code> 函数中，并且由于它返回的 <code>Promise</code> 对象运行的结果可能是 <code>rejected</code> ，所以最好放到 <code>try...catch</code> 语句中。</li><li><code>async</code> 函数返回的不再是 <code>return</code> 后面的数据，而是包含数据的 <code>Promise</code> 对象，因此调用它的位置需要改为 <code>Promise.then().catch()</code> 进行异常处理。（有点像 <code>axios.then().catch()</code>)</li></ul><h3 id="9-3-用户中心">9.3 用户中心</h3><p>新建 <code>frontend/src/views/UserCenter.vue</code>：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/views/UserCenter.vue --&gt;

&lt;template&gt;
  &lt;blog-header /&gt;
  &lt;div id="user-center"&gt;
    &lt;h3&gt;更新资料信息&lt;/h3&gt;
    &lt;form&gt;
      &lt;div class="form-elem"&gt;
        &lt;span&gt;用户名：&lt;/span&gt;
        &lt;input type="text" v-model="username" placeholder="输入用户名"&gt;
      &lt;/div&gt;
      &lt;div class="form-elem"&gt;
        &lt;span&gt;新密码：&lt;/span&gt;
        &lt;input type="password" v-model="password" placeholder="输入密码"&gt;
      &lt;/div&gt;
      &lt;div class="form-elem"&gt;
        &lt;button @click.prevent="changeInfo"&gt;更新&lt;/button&gt;
      &lt;/div&gt;
    &lt;/form&gt;
  &lt;/div&gt;
  &lt;blog-footer /&gt;
&lt;/template&gt;

&lt;script&gt;
import axios from 'axios'
import BlogHeader from '@/components/BlogHeader.vue';
import BlogFooter from '@/components/BlogFooter.vue';
import authorization from '@/utils/authorization'

const storage = localStorage

export default {
  name: 'UserCenter',
  components: {
    BlogHeader,
    BlogFooter
  },
  data() {
    return {
      username: '',
      password: '',
      token: '',
    }
  },
  mounted() {
    this.username = storage.getItem('username.myblog')
  },
  methods: {
    changeInfo() {
      authorization().then((resoponse) =&gt; {
        if (!resoponse[0]) {
          alert('登录已过期，请重新登录')
          return
        }
        console.log('Change info start')
        if (this.password.length &gt; 0 &amp;&amp; this.password.length &lt; 6) {
          alert('Password too short')
          return
        }
        const oldName = storage.getItem('username.myblog')
        let data = {}
        if (this.username !== '') {
          data.username = this.username
        }
        if (this.password !== '') {
          data.password = this.password
        }
        this.token = storage.getItem('access.myblog')
        axios.patch('/api/user/' + oldName + '/', data, { headers: { Authorization: 'Bearer ' + this.token } }).then((response) =&gt; {
          const name = response.data.username
          storage.setItem('username.myblog', name)
          this.$router.push({ name: 'UserCenter', params: { username: name } })
        })
      })
    }
  }
}

&lt;/script&gt;

&lt;style scoped&gt;
#user-center {
  text-align: center;
}

.form-elem {
  padding: 10px;
}

input {
  height: 25px;
  padding-left: 10px;
}

button {
  height: 35px;
  cursor: pointer;
  border: none;
  outline: none;
  background: gray;
  color: whitesmoke;
  border-radius: 5px;
  width: 200px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>检查函数返回的数据，如果登录失效，或者密码太短，则拒绝执行后面的逻辑。</li></ul><ul><li>拿到用户填写的表单数据，并取出保存在本地的令牌，发送到后端接口更新用户数据。</li></ul><p>修改<code>BlogHeader.vue</code>代码：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/components/BlogHeader.vue --&gt;

&lt;template&gt;
  &lt;div id="header"&gt;
    &lt;div class="grid"&gt;
      &lt;div&gt;&lt;/div&gt;
      &lt;h1&gt;My Django REST framework-Vue Blog&lt;/h1&gt;
      &lt;search-button /&gt;
    &lt;/div&gt;
    &lt;hr&gt;
    &lt;div class="login"&gt;
      &lt;div v-if="hasLogin"&gt;
        &lt;div class="dropdown"&gt;
          &lt;button class="dropbtn"&gt;欢迎，{{ username }}&lt;/button&gt;
          &lt;div class="dropdown-content"&gt;
            &lt;router-link :to="{ name: 'UserCenter', params: { username: username } }"&gt;用户中心&lt;/router-link&gt;
            &lt;router-link @click.prevent="logout()" :to="{ name: 'Home' }"&gt;注销&lt;/router-link&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div v-else&gt;
        &lt;router-link to="/login" class="login-link"&gt;登录&lt;/router-link&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import SearchButton from '@/components/SearchButton.vue'
import authorization from '@/utils/authorization'

export default {
  name: 'BlogHeader',
  data() {
    return {
      username: '',
      hasLogin: false,
    }
  },
  components: {
    SearchButton
  },
  mounted() {
    authorization().then((data) =&gt; [this.hasLogin, this.username] = data)
  },
  methods: {
    logout() {
      localStorage.clear()
      window.location.reload(false)
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
#header {
  text-align: center;
  margin-top: 20px;
}

.grid {
  display: grid;
  grid-template-columns: 1fr 4fr 1fr;
}

.login {
  text-align: right;
  padding-right: 5px;
}

.dropbtn {
  background-color: mediumaquamarine;
  color: white;
  padding: 8px 8px 30px 8px;
  font-size: 16px;
  border: none;
  cursor: pointer;
  height: 16px;
  border-radius: 5px;
}

.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f9f9f9;
  min-width: 120px;
  box-shadow: 0 8px 16px 0 rgb(0, 0, 0, 0.2);
  text-align: center;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

.dropdown-content a:hover {
  background-color: #f1f1f1;
}

.dropdown:hover .dropdown-content {
  display: block;
}

.dropdown:hover .dropbtn {
  background-color: darkslateblue;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>路由注册到<code>backend/src/router/index.js</code>：</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// backend/src/router/index.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> createRouter<span class="token punctuation">,</span> createWebHistory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span>

<span class="token keyword">const</span> <span class="token function-variable function">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/Home.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">ArticleDetail</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/ArticleDetail.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">Login</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/Login.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">UserCenter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/UserCenter.vue'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> Home
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/article/:id'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'ArticleDetail'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> ArticleDetail
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/login'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Login'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> Login
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/user/:username'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'UserCenter'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> UserCenter
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">history</span><span class="token operator">:</span> <span class="token function">createWebHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  routes<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="9-4-组件通信">9.4 组件通信</h3><p>Vue 中父组件向子组件传递信息的方式就是 <code>Props</code> 了，使用 Props 来实现欢迎词的更新。</p><p>修改<code>UserCenter.vue</code></p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/views/UserCenter.vue --&gt;

&lt;template&gt;
  &lt;blog-header :welcome-name="welcomeName" /&gt;
  &lt;div id="user-center"&gt;
    &lt;h3&gt;更新资料信息&lt;/h3&gt;
    &lt;form&gt;
      &lt;div class="form-elem"&gt;
        &lt;span&gt;用户名：&lt;/span&gt;
        &lt;input type="text" v-model="username" placeholder="输入用户名"&gt;
      &lt;/div&gt;
      &lt;div class="form-elem"&gt;
        &lt;span&gt;新密码：&lt;/span&gt;
        &lt;input type="password" v-model="password" placeholder="输入密码"&gt;
      &lt;/div&gt;
      &lt;div class="form-elem"&gt;
        &lt;button @click.prevent="changeInfo"&gt;更新&lt;/button&gt;
      &lt;/div&gt;
    &lt;/form&gt;
  &lt;/div&gt;
  &lt;blog-footer /&gt;
&lt;/template&gt;

&lt;script&gt;
import axios from 'axios'
import BlogHeader from '@/components/BlogHeader.vue';
import BlogFooter from '@/components/BlogFooter.vue';
import authorization from '@/utils/authorization'

const storage = localStorage

export default {
  name: 'UserCenter',
  components: {
    BlogHeader,
    BlogFooter
  },
  data() {
    return {
      username: '',
      password: '',
      token: '',
      welcomeName: '',
    }
  },
  mounted() {
    this.username = storage.getItem('username.myblog')
    this.welcomeName = storage.get('username.myblog')
  },
  methods: {
    changeInfo() {
      authorization().then((resoponse) =&gt; {
        if (!resoponse[0]) {
          alert('登录已过期，请重新登录')
          return
        }
        console.log('Change info start')
        if (this.password.length &gt; 0 &amp;&amp; this.password.length &lt; 6) {
          alert('Password too short')
          return
        }
        const oldName = storage.getItem('username.myblog')
        let data = {}
        if (this.username !== '') {
          data.username = this.username
        }
        if (this.password !== '') {
          data.password = this.password
        }
        this.token = storage.getItem('access.myblog')
        axios.patch('/api/user/' + oldName + '/', data, { headers: { Authorization: 'Bearer ' + this.token } }).then((response) =&gt; {
          const name = response.data.username
          storage.setItem('username.myblog', name)
          this.$router.push({ name: 'UserCenter', params: { username: name } })
          this.welcomeName = name
        })
      })
    }
  }
}

&lt;/script&gt;

&lt;style scoped&gt;
#user-center {
  text-align: center;
}

.form-elem {
  padding: 10px;
}

input {
  height: 25px;
  padding-left: 10px;
}

button {
  height: 35px;
  cursor: pointer;
  border: none;
  outline: none;
  background: gray;
  color: whitesmoke;
  border-radius: 5px;
  width: 200px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>可以看到组件是可以带参数的（也就是 Props 了），这个参数会传递到<strong>子组件</strong>中使用。</p><p>修改<code>BlogHeader.vue</code>：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/components/BlogHeader.vue --&gt;

&lt;template&gt;
  &lt;div id="header"&gt;
    &lt;div class="grid"&gt;
      &lt;div&gt;&lt;/div&gt;
      &lt;h1&gt;My Django REST framework-Vue Blog&lt;/h1&gt;
      &lt;search-button /&gt;
    &lt;/div&gt;
    &lt;hr&gt;
    &lt;div class="login"&gt;
      &lt;div v-if="hasLogin"&gt;
        &lt;div class="dropdown"&gt;
          &lt;button class="dropbtn"&gt;欢迎，{{ name }}&lt;/button&gt;
          &lt;div class="dropdown-content"&gt;
            &lt;router-link :to="{ name: 'UserCenter', params: { username: username } }"&gt;用户中心&lt;/router-link&gt;
            &lt;router-link @click.prevent="logout()" :to="{ name: 'Home' }"&gt;注销&lt;/router-link&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div v-else&gt;
        &lt;router-link to="/login" class="login-link"&gt;登录&lt;/router-link&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import SearchButton from '@/components/SearchButton.vue'
import authorization from '@/utils/authorization'

export default {
  name: 'BlogHeader',
  props: ['welcomeName'],
  data() {
    return {
      username: '',
      hasLogin: false,
    }
  },
  components: {
    SearchButton
  },
  mounted() {
    authorization().then((data) =&gt; [this.hasLogin, this.username] = data)
  },
  methods: {
    logout() {
      localStorage.clear()
      window.location.reload(false)
    }
  },
  computed: {
    name() {
      return this.welcomeName !== undefined ? this.welcomeName : this.username
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
#header {
  text-align: center;
  margin-top: 20px;
}

.grid {
  display: grid;
  grid-template-columns: 1fr 4fr 1fr;
}

.login {
  text-align: right;
  padding-right: 5px;
}

.dropbtn {
  background-color: mediumaquamarine;
  color: white;
  padding: 8px 8px 30px 8px;
  font-size: 16px;
  border: none;
  cursor: pointer;
  height: 16px;
  border-radius: 5px;
}

.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f9f9f9;
  min-width: 120px;
  box-shadow: 0 8px 16px 0 rgb(0, 0, 0, 0.2);
  text-align: center;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

.dropdown-content a:hover {
  background-color: #f1f1f1;
}

.dropdown:hover .dropdown-content {
  display: block;
}

.dropdown:hover .dropbtn {
  background-color: darkslateblue;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>computed</code> 计算属性：</p><ul><li><strong>计算属性是基于它们的响应式依赖进行缓存的</strong>。只在相关响应式依赖发生改变时它们才会重新求值。这就意味着只要与它有关系的参数没有发生改变，多次访问此计算属性会立即返回之前的计算结果，而不必再次执行函数。相比之下，每当触发重新渲染时，<strong>方法</strong>将<strong>总会</strong>再次执行函数。</li><li>**计算属性默认不接受参数，并且不能产生副作用。**也就是说，在它的执行过程中不能改变任何 Vue 所管理的数据，否则将会报错。计算属性是依赖数据工作的，副作用会使代码不可预测。</li></ul><p>一般来说，能用 <code>computed</code> 就尽量用它，不能的再考虑 <code>methods</code> ，算是用空间（缓存）换取时间（效率）</p><p>Vue 的子<strong>组件给父组件传递信息采用的是事件</strong>的形式。</p><p>Vuex 是一个专为 Vue 应用程序开发的<strong>状态管理模式</strong>。它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化。也就是说，Vuex 把组件的共享状态抽取出来，以一个全局单例模式管理。在这种模式下，组件树构成了一个巨大的“视图”，不管在树的哪个位置，任何组件都能获取状态或者触发行为。</p><p>Vuex 可以帮助我们管理共享状态，并附带了更多的概念和框架。这需要对短期和长期效益进行权衡。</p><p>如果您不打算开发大型单页应用，使用 Vuex 可能是繁琐冗余的；应用够简单，最好不要使用 Vuex。一个简单的 <a target="_blank" rel="noopener" href="https://cn.vuejs.org/v2/guide/state-management.html#%E7%AE%80%E5%8D%95%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E8%B5%B7%E6%AD%A5%E4%BD%BF%E7%94%A8">store 模式</a>就足够了。如果需要构建一个中大型单页应用，Vuex 将会成为自然而然的选择。中小型单页应用也可以使用 Pinia。</p><p>Props 虽然能够解决我们的问题，但总要持有 <code>welcomeName</code> 和 <code>username</code> 两个状态，可以使用 <code>ref</code> 访问子组件来改进。在 <code>BlogHeader.vue</code> 中写一个刷新数据的方法：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/components/BlogHeader.vue --&gt;

&lt;template&gt;
  &lt;div id="header"&gt;
    &lt;div class="grid"&gt;
      &lt;div&gt;&lt;/div&gt;
      &lt;h1&gt;My Django REST framework-Vue Blog&lt;/h1&gt;
      &lt;search-button /&gt;
    &lt;/div&gt;
    &lt;hr&gt;
    &lt;div class="login"&gt;
      &lt;div v-if="hasLogin"&gt;
        &lt;div class="dropdown"&gt;
          &lt;button class="dropbtn"&gt;欢迎，{{ username }}&lt;/button&gt;
          &lt;div class="dropdown-content"&gt;
            &lt;router-link :to="{ name: 'UserCenter', params: { username: username } }"&gt;用户中心&lt;/router-link&gt;
            &lt;router-link @click.prevent="logout()" :to="{ name: 'Home' }"&gt;注销&lt;/router-link&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div v-else&gt;
        &lt;router-link to="/login" class="login-link"&gt;登录&lt;/router-link&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import SearchButton from '@/components/SearchButton.vue'
import authorization from '@/utils/authorization'

export default {
  name: 'BlogHeader',
  data() {
    return {
      username: '',
      hasLogin: false,
    }
  },
  components: {
    SearchButton
  },
  mounted() {
    authorization().then((data) =&gt; [this.hasLogin, this.username] = data)
  },
  methods: {
    logout() {
      localStorage.clear()
      window.location.reload(false)
    },
    refresh() {
      this.username = localStorage.getItem('username.myblog')
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
#header {
  text-align: center;
  margin-top: 20px;
}

.grid {
  display: grid;
  grid-template-columns: 1fr 4fr 1fr;
}

.login {
  text-align: right;
  padding-right: 5px;
}

.dropbtn {
  background-color: mediumaquamarine;
  color: white;
  padding: 8px 8px 30px 8px;
  font-size: 16px;
  border: none;
  cursor: pointer;
  height: 16px;
  border-radius: 5px;
}

.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f9f9f9;
  min-width: 120px;
  box-shadow: 0 8px 16px 0 rgb(0, 0, 0, 0.2);
  text-align: center;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

.dropdown-content a:hover {
  background-color: #f1f1f1;
}

.dropdown:hover .dropdown-content {
  display: block;
}

.dropdown:hover .dropbtn {
  background-color: darkslateblue;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>然后在 <code>UserCenter.vue</code> 更新用户数据时访问此函数：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/views/UserCenter.vue --&gt;

&lt;template&gt;
  &lt;blog-header ref="header" /&gt;
  &lt;div id="user-center"&gt;
    &lt;h3&gt;更新资料信息&lt;/h3&gt;
    &lt;form&gt;
      &lt;div class="form-elem"&gt;
        &lt;span&gt;用户名：&lt;/span&gt;
        &lt;input type="text" v-model="username" placeholder="输入用户名"&gt;
      &lt;/div&gt;
      &lt;div class="form-elem"&gt;
        &lt;span&gt;新密码：&lt;/span&gt;
        &lt;input type="password" v-model="password" placeholder="输入密码"&gt;
      &lt;/div&gt;
      &lt;div class="form-elem"&gt;
        &lt;button @click.prevent="changeInfo"&gt;更新&lt;/button&gt;
      &lt;/div&gt;
    &lt;/form&gt;
  &lt;/div&gt;
  &lt;blog-footer /&gt;
&lt;/template&gt;

&lt;script&gt;
import axios from 'axios'
import BlogHeader from '@/components/BlogHeader.vue';
import BlogFooter from '@/components/BlogFooter.vue';
import authorization from '@/utils/authorization'

const storage = localStorage

export default {
  name: 'UserCenter',
  components: {
    BlogHeader,
    BlogFooter
  },
  data() {
    return {
      username: '',
      password: '',
      token: '',
    }
  },
  mounted() {
    this.username = storage.getItem('username.myblog')
  },
  methods: {
    changeInfo() {
      authorization().then((resoponse) =&gt; {
        if (!resoponse[0]) {
          alert('登录已过期，请重新登录')
          return
        }
        console.log('Change info start')
        if (this.password.length &gt; 0 &amp;&amp; this.password.length &lt; 6) {
          alert('Password too short')
          return
        }
        const oldName = storage.getItem('username.myblog')
        let data = {}
        if (this.username !== '') {
          data.username = this.username
        }
        if (this.password !== '') {
          data.password = this.password
        }
        this.token = storage.getItem('access.myblog')
        axios.patch('/api/user/' + oldName + '/', data, { headers: { Authorization: 'Bearer ' + this.token } }).then((response) =&gt; {
          const name = response.data.username
          storage.setItem('username.myblog', name)
          this.$router.push({ name: 'UserCenter', params: { username: name } })
          this.$refs.header.refresh()
        })
      })
    }
  }
}

&lt;/script&gt;

&lt;style scoped&gt;
#user-center {
  text-align: center;
}

.form-elem {
  padding: 10px;
}

input {
  height: 25px;
  padding-left: 10px;
}

button {
  height: 35px;
  cursor: pointer;
  border: none;
  outline: none;
  background: gray;
  color: whitesmoke;
  border-radius: 5px;
  width: 200px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="9-5-用户删除">9.5 用户删除</h3><p>删除用户按钮通常会放在用户中心页面，并且为了避免用户误操作，点击后还要进行第二次确认，方可删除。</p><p>修改 <code>UserCenter.vue</code> 文件：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/views/UserCenter.vue --&gt;

&lt;template&gt;
  &lt;blog-header ref="header" /&gt;
  &lt;div id="user-center"&gt;
    &lt;h3&gt;更新资料信息&lt;/h3&gt;
    &lt;form&gt;
      &lt;div class="form-elem"&gt;
        &lt;span&gt;用户名：&lt;/span&gt;
        &lt;input type="text" v-model="username" placeholder="输入用户名"&gt;
      &lt;/div&gt;
      &lt;div class="form-elem"&gt;
        &lt;span&gt;新密码：&lt;/span&gt;
        &lt;input type="password" v-model="password" placeholder="输入密码"&gt;
      &lt;/div&gt;
      &lt;div class="form-elem"&gt;
        &lt;button @click.prevent="changeInfo"&gt;更新&lt;/button&gt;
      &lt;/div&gt;
      &lt;div class="form-elem"&gt;
        &lt;button @click.prevent="showingDeleteAlert = true" class="delete-btn"&gt;删除用户&lt;/button&gt;
        &lt;div :class="{ shake: showingDeleteAlert }"&gt;
          &lt;button v-if="showingDeleteAlert" class="confirm-btn" @click.prevent="confirmDelete"&gt;
            确定？
          &lt;/button&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/form&gt;
  &lt;/div&gt;
  &lt;blog-footer /&gt;
&lt;/template&gt;

&lt;script&gt;
import axios from 'axios'
import BlogHeader from '@/components/BlogHeader.vue';
import BlogFooter from '@/components/BlogFooter.vue';
import authorization from '@/utils/authorization'

const storage = localStorage

export default {
  name: 'UserCenter',
  components: {
    BlogHeader,
    BlogFooter
  },
  data() {
    return {
      username: '',
      password: '',
      token: '',
      showingDeleteAlert: false
    }
  },
  mounted() {
    this.username = storage.getItem('username.myblog')
  },
  methods: {
    changeInfo() {
      authorization().then((resoponse) =&gt; {
        if (!resoponse[0]) {
          alert('登录已过期，请重新登录')
          return
        }
        console.log('Change info start')
        if (this.password.length &gt; 0 &amp;&amp; this.password.length &lt; 6) {
          alert('Password too short')
          return
        }
        const oldName = storage.getItem('username.myblog')
        let data = {}
        if (this.username !== '') {
          data.username = this.username
        }
        if (this.password !== '') {
          data.password = this.password
        }
        this.token = storage.getItem('access.myblog')
        axios.patch('/api/user/' + oldName + '/', data, { headers: { Authorization: 'Bearer ' + this.token } }).then((response) =&gt; {
          const name = response.data.username
          storage.setItem('username.myblog', name)
          this.$router.push({ name: 'UserCenter', params: { username: name } })
          this.$refs.header.refresh()
        })
      })
    },
    confirmDelete() {
      authorization().then((response) =&gt; {
        if (response[0]) {
          this.token = storage.getItem('access.myblog')
          axios.delete('/api/user/' + this.username + '/', { headers: { Authorization: 'Bearer ' + this.token } }).then(() =&gt; {
            storage.clear()
            this.$router.push({ name: 'Home' })
          })
        }
      })
    }
  }
}

&lt;/script&gt;

&lt;style scoped&gt;
#user-center {
  text-align: center;
}

.form-elem {
  padding: 10px;
}

input {
  height: 25px;
  padding-left: 10px;
}

button {
  height: 35px;
  cursor: pointer;
  border: none;
  outline: none;
  background: gray;
  color: whitesmoke;
  border-radius: 5px;
  width: 200px;
}

.confirm-btn {
  width: 80px;
  background-color: darkorange;
}

.delete-btn {
  background-color: darkred;
  margin-bottom: 10px;
}

.shake {
  animation: shake 0.82s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
  transform: translate3d(0, 0, 0);
  backface-visibility: hidden;
  perspective: 1000px;
}

@keyframes shake {

  10%,
  90% {
    transform: translate3d(-1px, 0, 0);
  }

  20%,
  80% {
    transform: translate3d(2px, 0, 0);
  }

  30%,
  50%,
  70% {
    transform: translate3d(-4px, 0, 0);
  }

  40%,
  60% {
    transform: translate3d(4px, 0, 0);
  }
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="10-文章操作">10. 文章操作</h2><h3 id="10-1-准备工作">10.1 准备工作</h3><p>修改后端文件 <code>user_info/serializers.py</code> ，增加返回<strong>当前用户</strong>是否为<strong>超级用户</strong>的信息</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># user_info/serializers.py</span>

<span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>models <span class="token keyword">import</span> User
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers


<span class="token keyword">class</span> <span class="token class-name">UserDescSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    文章列表中引用的嵌套用户信息
    """</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> User
        fields <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token string">'id'</span><span class="token punctuation">,</span>
            <span class="token string">'username'</span><span class="token punctuation">,</span>
            <span class="token string">'last_login'</span><span class="token punctuation">,</span>
            <span class="token string">'date_joined'</span>
        <span class="token punctuation">]</span>

<span class="token keyword">class</span> <span class="token class-name">UserRegisterSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    用户管理序列化器
    """</span>
    url <span class="token operator">=</span> serializers<span class="token punctuation">.</span>HyperlinkedIdentityField<span class="token punctuation">(</span>view_name<span class="token operator">=</span><span class="token string">'user-detail'</span><span class="token punctuation">,</span> lookup_field<span class="token operator">=</span><span class="token string">'username'</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> User
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'username'</span><span class="token punctuation">,</span> <span class="token string">'password'</span><span class="token punctuation">,</span> <span class="token string">'is_superuser'</span><span class="token punctuation">]</span>
        extra_kwargs <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'write_only'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'is_superuser'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'read_only'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    
    <span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> validated_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        user <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create_user<span class="token punctuation">(</span><span class="token operator">**</span>validated_data<span class="token punctuation">)</span>
        <span class="token keyword">return</span> user
    
    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> validated_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token string">'password'</span> <span class="token keyword">in</span> validated_data<span class="token punctuation">:</span>
            password <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span>
            instance<span class="token punctuation">.</span>set_password<span class="token punctuation">(</span>password<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>update<span class="token punctuation">(</span>instance<span class="token punctuation">,</span> validated_data<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">UserDetailSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> User
        fields <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token string">'id'</span><span class="token punctuation">,</span>
            <span class="token string">'username'</span><span class="token punctuation">,</span>
            <span class="token string">'first_name'</span><span class="token punctuation">,</span>
            <span class="token string">'last_name'</span><span class="token punctuation">,</span>
            <span class="token string">'email'</span><span class="token punctuation">,</span>
            <span class="token string">'last_login'</span><span class="token punctuation">,</span>
            <span class="token string">'date_joined'</span>
        <span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>修改后端文件 <code>article/views.py</code> ：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># article/views.py</span>

<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> viewsets<span class="token punctuation">,</span> filters

<span class="token keyword">from</span> article<span class="token punctuation">.</span>permissions <span class="token keyword">import</span> IsAdminUserOrReadOnly
<span class="token keyword">from</span> article<span class="token punctuation">.</span>models <span class="token keyword">import</span> Article<span class="token punctuation">,</span> Category<span class="token punctuation">,</span> Tag<span class="token punctuation">,</span> Avatar
<span class="token keyword">from</span> article<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> <span class="token punctuation">(</span>
    ArticleSerializer<span class="token punctuation">,</span>
    CategorySerializer<span class="token punctuation">,</span>
    CategoryDetailSerializer<span class="token punctuation">,</span>
    TagSerializer<span class="token punctuation">,</span>
    ArticleDetailSerializer<span class="token punctuation">,</span>
    AvatarSerializer<span class="token punctuation">,</span>
<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">AvatarViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    文章标题图视图集
    """</span>
    queryset <span class="token operator">=</span> Avatar<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> AvatarSerializer
    permission_classes <span class="token operator">=</span> <span class="token punctuation">[</span>IsAdminUserOrReadOnly<span class="token punctuation">]</span>


<span class="token keyword">class</span> <span class="token class-name">TagViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    标签视图集
    """</span>
    queryset <span class="token operator">=</span> Tag<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> TagSerializer
    permission_classes <span class="token operator">=</span> <span class="token punctuation">[</span>IsAdminUserOrReadOnly<span class="token punctuation">]</span>
    pagination_class <span class="token operator">=</span> <span class="token boolean">None</span>


<span class="token keyword">class</span> <span class="token class-name">CategoryViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    分类视图集
    """</span>
    queryset <span class="token operator">=</span> Category<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> CategorySerializer
    permission_classes <span class="token operator">=</span> <span class="token punctuation">[</span>IsAdminUserOrReadOnly<span class="token punctuation">]</span>
    pagination_class <span class="token operator">=</span> <span class="token boolean">None</span>

    <span class="token keyword">def</span> <span class="token function">get_serializer_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>action <span class="token operator">==</span> <span class="token string">'list'</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> CategorySerializer
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> CategoryDetailSerializer


<span class="token keyword">class</span> <span class="token class-name">ArticleViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    文章视图集
    """</span>
    queryset <span class="token operator">=</span> Article<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> ArticleSerializer
    permission_classes <span class="token operator">=</span> <span class="token punctuation">[</span>IsAdminUserOrReadOnly<span class="token punctuation">]</span>

    filter_backends <span class="token operator">=</span> <span class="token punctuation">[</span>filters<span class="token punctuation">.</span>SearchFilter<span class="token punctuation">]</span>
    search_fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">perform_create</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
        serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span>author<span class="token operator">=</span>self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>user<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">get_serializer_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>action <span class="token operator">==</span> <span class="token string">'list'</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> ArticleSerializer
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> ArticleDetailSerializer
    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="10-2-发布文章界面">10.2 发布文章界面</h3><p>在用户登录时追加记录用户<strong>是否为超级管理员</strong>：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/views/Login.vue --&gt;

&lt;template&gt;
  &lt;blog-header /&gt;

  &lt;div id="grid"&gt;
    &lt;div id="signup"&gt;
      &lt;h3&gt;注册账号&lt;/h3&gt;
      &lt;form&gt;
        &lt;div class="form-elem"&gt;
          &lt;span class="label"&gt;账号：&lt;/span&gt;
          &lt;input type="text" v-model="signupName" placeholder="输入用户名"&gt;
        &lt;/div&gt;
        &lt;div class="form-elem"&gt;
          &lt;span class="label"&gt;密码：&lt;/span&gt;
          &lt;input type="password" v-model="signupPwd" placeholder="输入密码"&gt;
        &lt;/div&gt;
        &lt;div class="form-elem"&gt;
          &lt;span class="label"&gt;确认密码：&lt;/span&gt;
          &lt;input type="password" v-model="signupPwdConfirm" placeholder="再次输入密码"&gt;
        &lt;/div&gt;
        &lt;div class="form-elem"&gt;
          &lt;button @click.prevent="signup"&gt;提交&lt;/button&gt;
        &lt;/div&gt;
      &lt;/form&gt;
    &lt;/div&gt;
    &lt;div id="signin"&gt;
      &lt;h3&gt;登录账号&lt;/h3&gt;
      &lt;form&gt;
        &lt;div class="form-elem"&gt;
          &lt;span class="label"&gt;账号：&lt;/span&gt;
          &lt;input type="text" v-model="signinName" placeholder="输入用户名"&gt;
        &lt;/div&gt;
        &lt;div class="form-elem"&gt;
          &lt;span class="label"&gt;密码：&lt;/span&gt;
          &lt;input type="password" v-model="signinPwd" placeholder="输入密码"&gt;
        &lt;/div&gt;
        &lt;div class="form-elem"&gt;
          &lt;button @click.prevent="signin"&gt;登录&lt;/button&gt;
        &lt;/div&gt;
      &lt;/form&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;blog-footer /&gt;
&lt;/template&gt;


&lt;script&gt;
import axios from 'axios'
import BlogHeader from '@/components/BlogHeader.vue';
import BlogFooter from '@/components/BlogFooter.vue';

export default {
  name: "Login",
  components: { BlogHeader, BlogFooter },
  data() {
    return {
      signupName: '',
      signupPwd: '',
      signupPwdConfirm: '',
      signinName: '',
      signinPwd: '',
      signupResponse: null,
    }
  },
  methods: {
    signup() {
      if (this.signupPwd !== this.signupPwdConfirm) {
        alert("两次密码不一致，请重新输入!")
        return
      }
      axios.post('/api/user/', {
        username: this.signupName,
        password: this.signupPwd,
      }).then((response) =&gt; {
        this.signupResponse = response.data
        alert('用户注册成功')
      }).catch((error) =&gt; {
        alert('用户注册失败:', error.message)
      })
    },
    signin() {
      axios.post('/api/token/', {
        username: this.signinName,
        password: this.signinPwd,
      }).then((response) =&gt; {
        const storage = localStorage
        const expiredTime = Date.parse(response.headers.date) + 10800000
        storage.setItem('access.myblog', response.data.access)
        storage.setItem('refresh.myblog', response.data.refresh)
        storage.setItem('expiredTime.myblog', expiredTime)
        storage.setItem('username.myblog', this.signinName)
        axios.get('/api/user/' + this.signinName + '/').then((response) =&gt; {
          storage.setItem('isSuperuser.myblog', response.data.is_superuser)
          this.$router.push({ name: 'Home' })
        })
      }).catch((error) =&gt; {
        alert('用户登录失败:', error.message)
      })
    }
  }
}

&lt;/script&gt;

&lt;style scoped&gt;
#grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
}

#signup {
  text-align: center;
}

#signin {
  text-align: center;
}

.form-elem {
  padding: 10px;
}

.label {
  display: inline-block;
  width: 80px;
  text-align: justify;
  text-align-last: justify;
  margin-right: 1px;
}

input {
  height: 25px;
  padding-left: 10px;
}

button {
  height: 35px;
  cursor: pointer;
  border: none;
  outline: none;
  background: gray;
  color: whitesmoke;
  border-radius: 5px;
  width: 60px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>发表文章页面 <code>frontend/src/views/ArticleCreate.vue</code>：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/views/ArticleCreate.vue --&gt;

&lt;template&gt;
  &lt;blog-header /&gt;
  &lt;div id="article-create"&gt;
    &lt;h3&gt;发表文章&lt;/h3&gt;
    &lt;form&gt;
      &lt;div class="form-elem"&gt;
        &lt;span&gt;标题：&lt;/span&gt;
        &lt;input type="text" v-model="title" placeholder="输入标题"&gt;
      &lt;/div&gt;
      &lt;div class="form-elem"&gt;
        &lt;span&gt;分类：&lt;/span&gt;
        &lt;span v-for="category in categories" :key="category.id"&gt;
          &lt;button class="category-btn" :style="categoryStyle(category)" @click.prevent="chooseCategory(category)"&gt;
            {{ category.title }}
          &lt;/button&gt;
        &lt;/span&gt;
      &lt;/div&gt;
      &lt;div class="form-elem"&gt;
        &lt;span&gt;标签：&lt;/span&gt;
        &lt;input type="text" v-model="tags" placeholder="输入标签，用逗号分隔"&gt;
      &lt;/div&gt;
      &lt;div class="form-elem"&gt;
        &lt;span&gt;正文：&lt;/span&gt;
        &lt;textarea v-model="body" placeholder="输入正文" cols="80" rows="20"&gt;&lt;/textarea&gt;
      &lt;/div&gt;
      &lt;div class="form-elem"&gt;
        &lt;button @click.prevent="submit"&gt;提交&lt;/button&gt;
      &lt;/div&gt;
    &lt;/form&gt;
  &lt;/div&gt;
  &lt;blog-footer /&gt;
&lt;/template&gt;

&lt;script&gt;
import BlogHeader from '@/components/BlogHeader.vue'
import BlogFooter from '@/components/BlogFooter.vue'
import axios from 'axios'
import authorization from '@/utils/authorization'

export default {
  name: 'ArticleCreate',
  components: {
    BlogHeader,
    BlogFooter
  },
  data() {
    return {
      title: '',
      body: '',
      categories: [],
      selectedCategory: null,
      tags: '',
    }
  },
  mounted() {
    axios.get('/api/category/').then((response) =&gt; {
      this.categories = response.data
    })
  },
  methods: {
    categoryStyle(category) {
      if (this.selectedCategory !== null &amp;&amp; category.id === this.selectedCategory.id) {
        return {
          backgroundColor: 'black'
        }
      }
      return {
        backgroundColor: 'lightgrey',
        color: 'black'
      }
    },
    chooseCategory(category) {
      if (this.selectedCategory !== null &amp;&amp; this.selectedCategory.id === category.id) {
        this.selectedCategory = null
      } else {
        this.selectedCategory = category
      }
    },
    submit() {
      authorization().then((response) =&gt; {
        if (response[0]) {
          let data = { title: this.title, body: this.body }
          if (this.selectedCategory) {
            data.category_id = this.selectedCategory.id
          }
          data.tags = this.tags.split(/[,，]/).map(x =&gt; x.trim()).filter(x =&gt; x.charAt(0) !== '')
          const token = localStorage.getItem('access.myblog')
          axios.post('/api/article/', data, { headers: { Authorization: 'Bearer ' + token } }).then((response) =&gt; {
            this.$router.push({ name: 'ArticleDetail', params: { id: response.data.id } })
          })
        } else {
          alert('令牌过期，请重新登录。')
        }
      })
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
.category-btn {
  margin-right: 10px;
}

#article-create {
  text-align: center;
  font-size: large;
}

form {
  text-align: left;
  padding-left: 100px;
  padding-right: 10px;
}

.form-elem {
  padding: 10px;
}

input {
  height: 25px;
  padding-left: 10px;
  width: 50%;
}

button {
  height: 35px;
  cursor: pointer;
  border: none;
  outline: none;
  background: steelblue;
  color: whitesmoke;
  border-radius: 5px;
  width: 60px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>注册发布文章页面的路由：</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// frontend/src/router/index.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> createRouter<span class="token punctuation">,</span> createWebHistory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span>

<span class="token keyword">const</span> <span class="token function-variable function">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/Home.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">ArticleDetail</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/ArticleDetail.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">Login</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/Login.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">UserCenter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/UserCenter.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">ArticleCreate</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/ArticleCreate.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> Home
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/article/:id'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'ArticleDetail'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> ArticleDetail
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/login'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Login'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> Login
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/user/:username'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'UserCenter'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> UserCenter<span class="token punctuation">,</span>
    <span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">requireAuth</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/article/create'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'ArticleCreate'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> ArticleCreate<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">history</span><span class="token operator">:</span> <span class="token function">createWebHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  routes<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>requireAuth<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'access.myblog'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> to<span class="token punctuation">.</span>params<span class="token punctuation">.</span>username <span class="token operator">===</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'username.myblog'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>params<span class="token punctuation">.</span>username <span class="token operator">!==</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'username.myblog'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">path</span><span class="token operator">:</span> from<span class="token punctuation">.</span>path
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token string">'/login'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'请先登录！'</span><span class="token punctuation">)</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/login'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>页眉的欢迎词下拉框用 <code>v-if</code> 仅对<strong>超级用户</strong>显示入口，普通用户不显示：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/components/BlogHeader.vue --&gt;

&lt;template&gt;
  &lt;div id="header"&gt;
    &lt;div class="grid"&gt;
      &lt;div&gt;&lt;/div&gt;
      &lt;h1&gt;My Django REST framework-Vue Blog&lt;/h1&gt;
      &lt;search-button /&gt;
    &lt;/div&gt;
    &lt;hr&gt;
    &lt;div class="login"&gt;
      &lt;div v-if="hasLogin"&gt;
        &lt;div class="dropdown"&gt;
          &lt;button class="dropbtn"&gt;欢迎，{{ username }}&lt;/button&gt;
          &lt;div class="dropdown-content"&gt;
            &lt;router-link :to="{ name: 'UserCenter', params: { username: username } }"&gt;用户中心&lt;/router-link&gt;
            &lt;router-link :to="{ name: 'ArticleCreate' }" v-if="isSuperuser"&gt;发布文章&lt;/router-link&gt;
            &lt;router-link @click.prevent="logout()" :to="{ name: 'Home' }"&gt;注销&lt;/router-link&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div v-else&gt;
        &lt;router-link to="/login" class="login-link"&gt;登录&lt;/router-link&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import SearchButton from '@/components/SearchButton.vue'
import authorization from '@/utils/authorization'

export default {
  name: 'BlogHeader',
  data() {
    return {
      username: '',
      hasLogin: false,
      isSuperuser: JSON.parse(localStorage.getItem('isSuperuser.myblog'))
    }
  },
  components: {
    SearchButton
  },
  mounted() {
    authorization().then((data) =&gt; [this.hasLogin, this.username] = data)
  },
  methods: {
    logout() {
      localStorage.clear()
      window.location.reload(false)
    },
    refresh() {
      this.username = localStorage.getItem('username.myblog')
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
#header {
  text-align: center;
  margin-top: 20px;
}

.grid {
  display: grid;
  grid-template-columns: 1fr 4fr 1fr;
}

.login {
  text-align: right;
  padding-right: 5px;
}

.dropbtn {
  background-color: mediumaquamarine;
  color: white;
  padding: 8px 8px 30px 8px;
  font-size: 16px;
  border: none;
  cursor: pointer;
  height: 16px;
  border-radius: 5px;
}

.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f9f9f9;
  min-width: 120px;
  box-shadow: 0 8px 16px 0 rgb(0, 0, 0, 0.2);
  text-align: center;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

.dropdown-content a:hover {
  background-color: #f1f1f1;
}

.dropdown:hover .dropdown-content {
  display: block;
}

.dropdown:hover .dropbtn {
  background-color: darkslateblue;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>为了让列表页面也能显示<strong>分类</strong>信息，稍微改一改 <code>ArticleList.vue</code> :</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/components/ArticleList.vue --&gt;

&lt;template&gt;
  &lt;div v-for="article in info.results" :key="article.url" id="articles"&gt;
    &lt;div&gt;
      &lt;span v-if="article.category !== null" class="category"&gt;{{ article.category.title }}&lt;/span&gt;
      &lt;span v-for="tag in article.tags" :key="tag" class="tag"&gt;
        {{ tag }}
      &lt;/span&gt;
    &lt;/div&gt;
    &lt;router-link :to="{ name: 'ArticleDetail', params: { id: article.id } }" class="article-title"&gt;
      {{ article.title }}
    &lt;/router-link&gt;
    &lt;div&gt;{{ formatted_time(article.created) }}&lt;/div&gt;
  &lt;/div&gt;
  &lt;div id="paginator"&gt;
    &lt;span v-if="is_page_exists('previous')"&gt;
      &lt;router-link :to="get_path('previous')"&gt;
        Prev
      &lt;/router-link&gt;
    &lt;/span&gt;
    &lt;span class="current-page"&gt;
      {{ get_page_param('current') }}
    &lt;/span&gt;
    &lt;span v-if="is_page_exists('next')"&gt;
      &lt;router-link :to="get_path('next')"&gt;
        Next
      &lt;/router-link&gt;
    &lt;/span&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import axios from 'axios'

export default {
  name: 'ArticleList',
  data() {
    return {
      info: '',
    }
  },
  mounted() {
    this.get_article_data()
  },
  methods: {
    // 判断页面是否存在
    is_page_exists(direction) {
      if (direction === 'next') {
        return this.info.next !== null
      }
      return this.info.previous !== null
    },
    // 获取页码
    get_page_param(direction) {
      try {
        let url_string
        switch (direction) {
          case 'next':
            url_string = this.info.next
            break
          case 'previous':
            url_string = this.info.previous
            break
          default:
            if (!('page' in this.$route.query)) {
              return 1
            }
            if (this.$route.query.page === null) {
              return 1
            }
            return this.$route.query.page
        }
        const url = new URL(url_string)
        return url.searchParams.get('page')
      } catch (err) {
        return
      }
    },
    // 获取文章列表数据
    get_article_data() {
      let url = '/api/article/'
      let params = new URLSearchParams()
      if (this.isExists(this.$route.query.page)) {
        params.append('page', this.$route.query.page)
      }
      if (this.isExists(this.$route.query.search)) {
        params.append('search', this.$route.query.search)
      }
      const paramsString = params.toString()
      if (paramsString.charAt(0) !== '') {
        url += '/?' + paramsString
      }
      axios.get(url).then(response =&gt; {
        this.info = response.data
      }).catch(error =&gt; {
        console.log(error)
      })
    },
    // 获取路径
    get_path(direction) {
      let url = ''
      try {
        switch (direction) {
          case 'next':
            if (this.info.next !== undefined) {
              url += (new URL(this.info.next)).search
            }
            break
          case 'previous':
            if (this.info.previous !== undefined) {
              url += (new URL(this.info.previous)).search
            }
            break
        }
      } catch {
        return url
      }
      return url
    },
    // 检查参数是否存在
    isExists(value) {
      return value !== null &amp;&amp; value !== undefined
    }
  },
  watch: {
    // 监听路由变化
    $route() {
      this.get_article_data()
    }
  },
  computed: {
    // 格式化时间
    formatted_time() {
      return timeString =&gt; new Date(timeString).toLocaleDateString()
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
#articles {
  padding: 10px;
}

.article-title {
  font-size: large;
  font-weight: bolder;
  color: black;
  text-decoration: none;
  padding: 5px 0 5px 0;
}

.tag {
  padding: 2px 5px 2px 5px;
  margin: 5px 5px 5px 0;
  font-family: Georgia, Arial, sans-serif;
  font-size: small;
  background-color: #4e4e4e;
  color: whitesmoke;
  border-radius: 5px;
}

#paginator {
  text-align: center;
  padding-top: 50px;
}

a {
  color: black;
}

.current-page {
  font-size: x-large;
  font-weight: bold;
  padding-left: 10px;
  padding-right: 10px;
}

.category {
  padding: 5px 10px 5px 10px;
  margin: 5px 5px 5px 0;
  font-family: Georgia, Arial, sans-serif;
  font-size: small;
  background-color: darkred;
  color: whitesmoke;
  border-radius: 15px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="10-3-文章更新与删除页面">10.3 文章更新与删除页面</h3><p>新建 <code>frontend/src/views/ArticleEdit.vue</code> 文件：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/views/ArticleEdit.vue --&gt;

&lt;template&gt;
  &lt;blog-header /&gt;
  &lt;div id="article-create"&gt;
    &lt;h3&gt;更新文章&lt;/h3&gt;
    &lt;form&gt;
      &lt;div class="form-elem"&gt;
        &lt;span&gt;标题：&lt;/span&gt;
        &lt;input type="text" v-model="title" placeholder="输入标题"&gt;
      &lt;/div&gt;
      &lt;div class="form-elem"&gt;
        &lt;span&gt;分类：&lt;/span&gt;
        &lt;span v-for="category in categories" :key="category.id"&gt;
          &lt;button class="category-btn" :style="categoryStyle(category)" @click.prevent="chooseCategory(category)"&gt;
            {{ category.title }}
          &lt;/button&gt;
        &lt;/span&gt;
      &lt;/div&gt;
      &lt;div class="form-elem"&gt;
        &lt;span&gt;标签：&lt;/span&gt;
        &lt;input type="text" v-model="tags" placeholder="输入标签，用逗号分隔"&gt;
      &lt;/div&gt;
      &lt;div class="form-elem"&gt;
        &lt;span&gt;正文：&lt;/span&gt;
        &lt;textarea v-model="body" placeholder="输入正文" cols="80" rows="20"&gt;&lt;/textarea&gt;
      &lt;/div&gt;
      &lt;div class="form-elem"&gt;
        &lt;button @click.prevent="submit"&gt;提交&lt;/button&gt;
      &lt;/div&gt;
      &lt;div class="form-elem"&gt;
        &lt;button @click.prevent="deleteArticle" style="background-color: darkred;"&gt;删除&lt;/button&gt;
      &lt;/div&gt;
    &lt;/form&gt;
  &lt;/div&gt;
  &lt;blog-footer /&gt;
&lt;/template&gt;


&lt;script&gt;
import BlogHeader from '@/components/BlogHeader.vue'
import BlogFooter from '@/components/BlogFooter.vue'
import axios from 'axios'
import authorization from '@/utils/authorization'

export default {
  name: 'ArticleEdit',
  components: {
    BlogHeader,
    BlogFooter,
  },
  data() {
    return {
      title: '',
      body: '',
      categories: [],
      selectedCategory: null,
      tags: '',
      articleID: null,
    }
  },
  mounted() {
    axios.get('/api/category/').then(response =&gt; this.categories = response.data)
    axios.get('/api/article/' + this.$route.params.id + '/').then((response) =&gt; {
      this.title = response.data.title
      this.body = response.data.body
      this.selectedCategory = response.data.category
      this.tags = response.data.tags.join(',')
      this.articleID = response.data.id
    })
  },
  methods: {
    categoryStyle(category) {
      if (this.selectedCategory !== null &amp;&amp; category.id === this.selectedCategory.id) {
        return {
          backgroundColor: 'black',
        }
      }
      return {
        backgroundColor: 'lightgrey',
        color: 'black'
      }
    },
    chooseCategory(category) {
      if (this.selectedCategory !== null &amp;&amp; category.id == this.selectedCategory.id) {
        this.selectedCategory = null
      } else {
        this.selectedCategory = category
      }
    },
    submit() {
      authorization().then((response) =&gt; {
        if (response[0]) {
          let data = {
            title: this.title,
            body: this.body
          }

          data.category_id = this.selectedCategory ? this.selectedCategory.id : null
          data.tags = this.tags.split(/[,，]/).map(x =&gt; x.trim()).filter(x =&gt; x.charAt(0) !== '')
          const token = localStorage.getItem('access.myblog')
          axios.put('/api/article/' + this.articleID + '/', data, { headers: { Authorization: 'Bearer ' + token } }).then((response) =&gt; {
            this.$router.push({ name: 'ArticleDetail', params: { id: response.data.id } })
          })
        } else {
          alert('令牌过期，请重新登录')
        }
      })
    },
    deleteArticle() {
      const token = localStorage.getItem('access.myblog')
      authorization().then((response) =&gt; {
        if (response[0]) {
          axios.delete('/api/article/' + this.articleID + '/', { headers: { Authorization: 'Bearer ' + token } }).then((response) =&gt; {
            this.$router.push({ name: 'Home' })
          })
        } else {
          alert('令牌过期，请重新登录')
        }
      })
    }
  }
}

&lt;/script&gt;

&lt;style scoped&gt;
.category-btn {
  margin-left: 10px;
}

#article-create {
  text-align: center;
  font-size: large;
}

form {
  text-align: left;
  padding-left: 100px;
  padding-right: 10px;
}

.form-elem {
  padding: 10px;
}

input {
  height: 25px;
  padding-left: 10px;
  width: 50%;
}

button {
  height: 35px;
  cursor: pointer;
  border: none;
  outline: none;
  background: steelblue;
  color: whitesmoke;
  border-radius: 5px;
  width: 60px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>注册路由：</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// frontend/src/router/index.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> createRouter<span class="token punctuation">,</span> createWebHistory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span>

<span class="token keyword">const</span> <span class="token function-variable function">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/Home.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">ArticleDetail</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/ArticleDetail.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">Login</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/Login.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">UserCenter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/UserCenter.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">ArticleCreate</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/ArticleCreate.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">ArticleEdit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/ArticleEdit.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> Home
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/article/:id'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'ArticleDetail'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> ArticleDetail
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/login'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Login'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> Login
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/user/:username'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'UserCenter'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> UserCenter<span class="token punctuation">,</span>
    <span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">requireAuth</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/article/create'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'ArticleCreate'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> ArticleCreate<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/article/edit/:id'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'ArticleEdit'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> ArticleEdit<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">history</span><span class="token operator">:</span> <span class="token function">createWebHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  routes<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>requireAuth<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'access.myblog'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> to<span class="token punctuation">.</span>params<span class="token punctuation">.</span>username <span class="token operator">===</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'username.myblog'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>params<span class="token punctuation">.</span>username <span class="token operator">!==</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'username.myblog'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">path</span><span class="token operator">:</span> from<span class="token punctuation">.</span>path
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token string">'/login'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'请先登录！'</span><span class="token punctuation">)</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/login'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在文章详情页中放一个更新和删除页面的入口：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/views/ArticleDetail.vue --&gt;

&lt;template&gt;
  &lt;blog-header /&gt;
  &lt;div v-if="article !== null" class="grid-container"&gt;
    &lt;div&gt;
      &lt;h1 id="title"&gt;{{ article.title }}&lt;/h1&gt;
      &lt;p id="subtitle"&gt;本文由 {{ article.author.username }} 发布于 {{ formatted_time }}
        &lt;span if="isSuperuser"&gt;
          &lt;router-link :to="{ name: 'ArticleEdit', params: { id: article.id } }"&gt;更新与删除&lt;/router-link&gt;
        &lt;/span&gt;
      &lt;/p&gt;
      &lt;div v-html="article.body_html" class="article-body"&gt;&lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;h3&gt;目录&lt;/h3&gt;
      &lt;div v-html="article.toc_html" class="toc"&gt;&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;blog-footer /&gt;
&lt;/template&gt;
  
&lt;script&gt;
import BlogHeader from '@/components/BlogHeader.vue'
import BlogFooter from '@/components/BlogFooter.vue'
import axios from 'axios'

export default {
  name: 'ArticleDetail',
  components: { BlogHeader, BlogFooter },
  data() {
    return {
      article: null
    }
  },
  mounted() {
    axios.get('/api/article/' + this.$route.params.id).then(response =&gt; {
      this.article = response.data
    }).catch(error =&gt; {
      console.log(error)
    })
  },
  computed: {
    formatted_time() {
      return new Date(this.article.created).toLocaleDateString()
    },
    isSuperuser() {
      return localStorage.getItem('isSuperuser.myblog') === 'true'
    }
  }
}
&lt;/script&gt;
  
&lt;style scoped&gt;
.grid-container {
  display: grid;
  grid-template-columns: 3fr 1fr;
}

#title {
  text-align: center;
  font-size: x-large;
}

#subtitle {
  text-align: center;
  color: gray;
  font-size: small;
}
&lt;/style&gt;


&lt;style&gt;
.article-body p img {
  max-width: 100%;
  border-radius: 50px;
  box-shadow: gray 0 0 20px;
}

.toc ul {
  list-style-type: none;
}

.toc a {
  color: gray;
}
&lt;/style&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="10-4-文章标题图">10.4 文章标题图</h3><p><strong>图片提交</strong>的流程：在 <code>multipart/form-data</code> 中发送文件，然后将保存好的文件 id 返回给客户端。客户端拿到文件 id 后，发送带有 id 的 Json 数据，在服务器端将它们关联起来。</p><ul><li>在发表新文章页面中选定图片后，不等待文章的提交而是立即将图片上传。</li><li>图片上传成功后返回图片 id，前端将 id 保存待用。</li><li>提交文章时，将图片 id 一并打包提交即可。</li></ul><p>在 <code>ArticleCreate.vue</code> 中添加代码：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/views/ArticleCreate.vue --&gt;

&lt;!-- frontend/src/views/ArticleCreate.vue --&gt;

&lt;template&gt;
  &lt;BlogHeader /&gt;
  &lt;div id="article-create"&gt;
    &lt;h3&gt;发表文章&lt;/h3&gt;
    &lt;form id="image-form"&gt;
      &lt;div class="form-elem"&gt;
        &lt;span&gt;图片：&lt;/span&gt;
        &lt;input type="file" id="file" @change="onFileChange"&gt;
      &lt;/div&gt;
    &lt;/form&gt;
    &lt;form&gt;
      &lt;div class="form-elem"&gt;
        &lt;span&gt;标题：&lt;/span&gt;
        &lt;input v-model="title" type="text" placeholder="输入标题"&gt;
      &lt;/div&gt;

      &lt;div class="form-elem"&gt;
        &lt;span&gt;分类：&lt;/span&gt;
        &lt;span v-for="category in categories" :key="category.id"&gt;
          &lt;!--样式也可以通过 :style 绑定--&gt;
          &lt;button class="category-btn" :style="categoryStyle(category)" @click.prevent="chooseCategory(category)"&gt;
            {{ category.title }}
          &lt;/button&gt;
        &lt;/span&gt;
      &lt;/div&gt;

      &lt;div class="form-elem"&gt;
        &lt;span&gt;标签：&lt;/span&gt;
        &lt;input v-model="tags" type="text" placeholder="输入标签，用逗号分隔"&gt;
      &lt;/div&gt;

      &lt;div class="form-elem"&gt;
        &lt;span&gt;正文：&lt;/span&gt;
        &lt;textarea v-model="body" placeholder="输入正文" rows="20" cols="80"&gt;&lt;/textarea&gt;
      &lt;/div&gt;

      &lt;div class="form-elem"&gt;
        &lt;button v-on:click.prevent="submit"&gt;提交&lt;/button&gt;
      &lt;/div&gt;
    &lt;/form&gt;
  &lt;/div&gt;
  &lt;BlogFooter /&gt;
&lt;/template&gt;

&lt;script&gt;
import BlogHeader from '@/components/BlogHeader.vue'
import BlogFooter from '@/components/BlogFooter.vue'
import axios from 'axios';
import authorization from '@/utils/authorization';

export default {
  name: 'ArticleCreate',
  components: { BlogHeader, BlogFooter },
  data: function () {
    return {
      // 文章标题
      title: '',
      // 文章正文
      body: '',
      // 数据库中所有的分类
      categories: [],
      // 选定的分类
      selectedCategory: null,
      // 标签
      tags: '',
      // 标题图
      avatarID: null
    }
  },
  mounted() {
    // 页面初始化时获取所有分类
    axios
      .get('/api/category/')
      .then(response =&gt; this.categories = response.data)
  },
  methods: {
    onFileChange(e) {
      // 将文件二进制数据添加到提交数据中
      const file = e.target.files[0]
      let formData = new FormData()
      formData.append("content", file)
      axios.post('/api/avatar/', formData, { headers: { 'Content-Type': 'multipart/form-data', 'Authorization': 'Bearer ' + localStorage.getItem('access.myblog') } }).then((response) =&gt; {
        this.avatarID = response.data.id
      })
    },
    // 根据分类是否被选中，按钮的颜色发生变化
    // 这里可以看出 css 也是可以被 vue 绑定的，很方便
    categoryStyle(category) {
      if (this.selectedCategory !== null &amp;&amp; category.id === this.selectedCategory.id) {
        return {
          backgroundColor: 'black',
        }
      }
      return {
        backgroundColor: 'lightgrey',
        color: 'black',
      }
    },
    // 选取分类的方法
    chooseCategory(category) {
      // 如果点击已选取的分类，则将 selectedCategory 置空
      if (this.selectedCategory !== null &amp;&amp; this.selectedCategory.id === category.id) {
        this.selectedCategory = null
      }
      // 如果没选中当前分类，则选中它
      else {
        this.selectedCategory = category;
      }
    },
    // 点击提交按钮
    submit() {
      const that = this;
      // 前面封装的验证函数又用上了
      authorization()
        .then(function (response) {
          if (response[0]) {
            // 需要传给后端的数据字典
            let data = {
              title: that.title,
              body: that.body,
            };
            // 添加分类
            if (that.selectedCategory) {
              data.category_id = that.selectedCategory.id
            }
            // 标签预处理
            data.tags = that.tags
              // 用逗号分隔标签
              .split(/[,，]/)
              // 剔除标签首尾空格
              .map(x =&gt; x.trim())
              // 剔除长度为零的无效标签
              .filter(x =&gt; x.charAt(0) !== '');
            data.avatar_id = this.avatarID
            // 将发表文章请求发送至接口
            // 成功后前往详情页面
            const token = localStorage.getItem('access.myblog');
            axios
              .post('/api/article/',
                data,
                {
                  headers: { Authorization: 'Bearer ' + token }
                })
              .then(function (response) {
                that.$router.push({ name: 'ArticleDetail', params: { id: response.data.id } });
              })
          }
          else {
            alert('令牌过期，请重新登录。')
          }
        }
        )
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
.category-btn {
  margin-right: 10px;
}

#article-create {
  text-align: center;
  font-size: large;
}

form {
  text-align: left;
  padding-left: 100px;
  padding-right: 10px;
}

.form-elem {
  padding: 10px;
}

input {
  height: 25px;
  padding-left: 10px;
  width: 50%;
}

button {
  height: 35px;
  cursor: pointer;
  border: none;
  outline: none;
  background: steelblue;
  color: whitesmoke;
  border-radius: 5px;
  width: 60px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>新增了一个<strong>表单</strong>（不用表单其实也没关系），表单含有一个提交文件的控件；<code>v-on:change</code> 将控件绑定到 <code>onFileChange()</code> 方法，即只要用户选定了任何图片，都会触发此方法。</li><li><code>onFileChange(e)</code> 中的参数为控件所触发的事件对象。由于图片二进制流不能以简单的字符串数据进行表示，所以将其添加到 <code>FormData</code> 表单对象中，发送到图片上传接口。若接口返回成功，则将返回的 id 值保存待用。</li><li><code>submit()</code> 对应增加了图片 id 的赋值语句。</li></ul><p>接下来在文章列表页面<strong>显示</strong>它，修改 <code>ArticleList.vue</code> 代码。</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;template&gt;
  &lt;div v-for="article in info.results" :key="article.url" id="articles"&gt;
    &lt;div class="grid" :style="gridStyle(article)"&gt;
      &lt;div class="image-container"&gt;
        &lt;img :src="imageIfExists(article)" alt="" class="image" accept="image/gif, image/jpeg"&gt;
      &lt;/div&gt;
      &lt;div&gt;
        &lt;div&gt;
          &lt;span v-if="article.category !== null" class="category"&gt;{{ article.category.title }}&lt;/span&gt;
          &lt;span v-for="tag in article.tags" :key="tag" class="tag"&gt;
            {{ tag }}
          &lt;/span&gt;
        &lt;/div&gt;
        &lt;router-link :to="{ name: 'ArticleDetail', params: { id: article.id } }" class="article-title"&gt;
          {{ article.title }}
        &lt;/router-link&gt;
        &lt;div&gt;{{ formatted_time(article.created) }}&lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div id="paginator"&gt;
    &lt;span v-if="is_page_exists('previous')"&gt;
      &lt;router-link :to="get_path('previous')"&gt;
        Prev
      &lt;/router-link&gt;
    &lt;/span&gt;
    &lt;span class="current-page"&gt;
      {{ get_page_param('current') }}
    &lt;/span&gt;
    &lt;span v-if="is_page_exists('next')"&gt;
      &lt;router-link :to="get_path('next')"&gt;
        Next
      &lt;/router-link&gt;
    &lt;/span&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import axios from 'axios'

export default {
  name: 'ArticleList',
  data() {
    return {
      info: '',
    }
  },
  mounted() {
    this.get_article_data()
  },
  methods: {
    // 判断标题图是否存在并返回图像
    imageIfExists(article) {
      if (article.avatar) {
        return article.avatar.content
      }
    },
    // 修改grid样式
    gridStyle(article) {
      if (article.avatar) {
        return {
          display: 'grid',
          gridTemplateColumns: '1fr 7fr'
        }
      }
    },
    // 判断页面是否存在
    is_page_exists(direction) {
      if (direction === 'next') {
        return this.info.next !== null
      }
      return this.info.previous !== null
    },
    // 获取页码
    get_page_param(direction) {
      try {
        let url_string
        switch (direction) {
          case 'next':
            url_string = this.info.next
            break
          case 'previous':
            url_string = this.info.previous
            break
          default:
            if (!('page' in this.$route.query)) {
              return 1
            }
            if (this.$route.query.page === null) {
              return 1
            }
            return this.$route.query.page
        }
        const url = new URL(url_string)
        return url.searchParams.get('page')
      } catch (err) {
        return
      }
    },
    // 获取文章列表数据
    get_article_data() {
      let url = '/api/article/'
      let params = new URLSearchParams()
      if (this.isExists(this.$route.query.page)) {
        params.append('page', this.$route.query.page)
      }
      if (this.isExists(this.$route.query.search)) {
        params.append('search', this.$route.query.search)
      }
      const paramsString = params.toString()
      if (paramsString.charAt(0) !== '') {
        url += '/?' + paramsString
      }
      axios.get(url).then(response =&gt; {
        this.info = response.data
      }).catch(error =&gt; {
        console.log(error)
      })
    },
    // 获取路径
    get_path(direction) {
      let url = ''
      try {
        switch (direction) {
          case 'next':
            if (this.info.next !== undefined) {
              url += (new URL(this.info.next)).search
            }
            break
          case 'previous':
            if (this.info.previous !== undefined) {
              url += (new URL(this.info.previous)).search
            }
            break
        }
      } catch {
        return url
      }
      return url
    },
    // 检查参数是否存在
    isExists(value) {
      return value !== null &amp;&amp; value !== undefined
    }
  },
  watch: {
    // 监听路由变化
    $route() {
      this.get_article_data()
    }
  },
  computed: {
    // 格式化时间
    formatted_time() {
      return timeString =&gt; new Date(timeString).toLocaleDateString()
    }
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
#articles {
  padding: 10px;
}

.article-title {
  font-size: large;
  font-weight: bolder;
  color: black;
  text-decoration: none;
  padding: 5px 0 5px 0;
}

.tag {
  padding: 2px 5px 2px 5px;
  margin: 5px 5px 5px 0;
  font-family: Georgia, Arial, sans-serif;
  font-size: small;
  background-color: #4e4e4e;
  color: whitesmoke;
  border-radius: 5px;
}

#paginator {
  text-align: center;
  padding-top: 50px;
}

a {
  color: black;
}

.current-page {
  font-size: x-large;
  font-weight: bold;
  padding-left: 10px;
  padding-right: 10px;
}

.category {
  padding: 5px 10px 5px 10px;
  margin: 5px 5px 5px 0;
  font-family: Georgia, Arial, sans-serif;
  font-size: small;
  background-color: darkred;
  color: whitesmoke;
  border-radius: 15px;
}

.image {
  width: 180px;
  border-radius: 10px;
  box-shadow: darkslategrey 0 0 12px;
}

.image-container {
  width: 200px;
}

.grid {
  padding-bottom: 10px;
}
&lt;/style&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="11-发布评论">11. 发布评论</h2><h3 id="11-1-发布评论组件">11.1 发布评论组件</h3><p>新建 <code>frontend/src/components/Comments.vue</code>：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/components/Comments.vue --&gt;

&lt;template&gt;
  &lt;br&gt;&lt;br&gt;
  &lt;hr&gt;
  &lt;h3&gt;发表评论&lt;/h3&gt;
  &lt;!-- 评论多行文本输入控件 --&gt;
  &lt;textarea v-model="message" :placeholder="placeholder" name="comment" id="comment-area" cols="60" rows="10"&gt;&lt;/textarea&gt;
  &lt;div&gt;
    &lt;button @click="submit" class="submitBtn"&gt;发布&lt;/button&gt;
  &lt;/div&gt;

  &lt;br&gt;
  &lt;p&gt;已有 {{ comments.length }} 条评论&lt;/p&gt;
  &lt;hr&gt;

  &lt;!-- 渲染所有评论内容 --&gt;
  &lt;div v-for="comment in comments" :key="comment.id"&gt;
    &lt;div class="comments"&gt;
      &lt;div&gt;
        &lt;span class="username"&gt;
          {{ comment.author.username }}
        &lt;/span&gt;
        于
        &lt;span class="created"&gt;
          {{ formatted_time(comment.created) }}
        &lt;/span&gt;
        &lt;span v-if="comment.parent"&gt;
          对
          &lt;span class="parent"&gt;
            {{ comment.parent.author.username }}
          &lt;/span&gt;
        &lt;/span&gt;
        说道：
      &lt;/div&gt;
      &lt;div class="content"&gt;
        {{ comment.content }}
      &lt;/div&gt;
      &lt;div&gt;
        &lt;button class="commentBtn" @click="replyTo(comment)"&gt;回复&lt;/button&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;hr&gt;
  &lt;/div&gt;
&lt;/template&gt;
  
&lt;script&gt;
import axios from 'axios';
import authorization from '@/utils/authorization';

export default {
  name: 'Comments',
  // 通过 props 获取当前文章
  props: { article: Object },
  data() {
    return {
      // 所有评论
      comments: [],
      // 评论控件绑定的文本和占位符
      message: '',
      placeholder: '说点啥吧...',
      // 评论的评论
      parentID: null
    }
  },
  // 监听 article 对象
  // 以便实时更新评论
  watch: {
    article() {
      this.comments = this.article !== null ? this.article.comments : []
    }
  },
  methods: {
    // 提交评论
    submit() {
      authorization().then((response) =&gt; {
        if (response[0]) {
          axios.post('/api/comment/', { content: this.message, article_id: this.article.id, parent_id: this.parentID }, { headers: { Authorization: 'Bearer ' + localStorage.getItem('access.myblog') } }).then((response) =&gt; {
            // 将新评论添加到顶部
            this.comments.unshift(response.data);
            this.message = '';
            alert('留言成功')
          })
        } else {
          alert('请登录后评论。')
        }
      })
    },
    // 对某条评论进行评论
    // 即二级评论
    replyTo(comment) {
      this.parentID = comment.id;
      this.placeholder = '对' + comment.author.username + '说:'
    },
  },
  computed: {
    // 格式化时间
    formatted_time() {
      return timeString =&gt; new Date(timeString).toLocaleDateString()
    }
  }
}
&lt;/script&gt;
  
&lt;style scoped&gt;
button {
  cursor: pointer;
  border: none;
  outline: none;
  color: whitesmoke;
  border-radius: 5px;
}

.submitBtn {
  height: 35px;
  background: steelblue;
  width: 60px;
}

.commentBtn {
  height: 25px;
  background: lightslategray;
  width: 40px;
}

.comments {
  padding-top: 10px;
}

.username {
  font-weight: bold;
  color: darkorange;
}

.created {
  font-weight: bold;
  color: darkblue;
}

.parent {
  font-weight: bold;
  color: orangered;
}

.content {
  font-size: large;
  padding: 15px;
}
&lt;/style&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="11-2-添加发布评论功能">11.2 添加发布评论功能</h3><p>修改 <code>ArticleDetail.vue</code> ，使用 <code>Comments</code> <strong>组件</strong>：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/views/ArticleDetail.vue --&gt;

&lt;template&gt;
  &lt;blog-header /&gt;
  &lt;div v-if="article !== null" class="grid-container"&gt;
    &lt;div&gt;
      &lt;h1 id="title"&gt;{{ article.title }}&lt;/h1&gt;
      &lt;p id="subtitle"&gt;本文由 {{ article.author.username }} 发布于 {{ formatted_time }}
        &lt;span if="isSuperuser"&gt;
          &lt;router-link :to="{ name: 'ArticleEdit', params: { id: article.id } }"&gt;更新与删除&lt;/router-link&gt;
        &lt;/span&gt;
      &lt;/p&gt;
      &lt;div v-html="article.body_html" class="article-body"&gt;&lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;h3&gt;目录&lt;/h3&gt;
      &lt;div v-html="article.toc_html" class="toc"&gt;&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;comments :article="article" /&gt;
  &lt;blog-footer /&gt;
&lt;/template&gt;
  
&lt;script&gt;
import BlogHeader from '@/components/BlogHeader.vue'
import BlogFooter from '@/components/BlogFooter.vue'
import Comments from '@/components/Comments.vue'
import axios from 'axios'

export default {
  name: 'ArticleDetail',
  components: { BlogHeader, BlogFooter, Comments },
  data() {
    return {
      article: null
    }
  },
  mounted() {
    axios.get('/api/article/' + this.$route.params.id).then(response =&gt; {
      this.article = response.data
    }).catch(error =&gt; {
      console.log(error)
    })
  },
  computed: {
    formatted_time() {
      return new Date(this.article.created).toLocaleDateString()
    },
    isSuperuser() {
      return localStorage.getItem('isSuperuser.myblog') === 'true'
    }
  }
}
&lt;/script&gt;
  
&lt;style scoped&gt;
.grid-container {
  display: grid;
  grid-template-columns: 3fr 1fr;
}

#title {
  text-align: center;
  font-size: x-large;
}

#subtitle {
  text-align: center;
  color: gray;
  font-size: small;
}
&lt;/style&gt;


&lt;style&gt;
.article-body p img {
  max-width: 100%;
  border-radius: 50px;
  box-shadow: gray 0 0 20px;
}

.toc ul {
  list-style-type: none;
}

.toc a {
  color: gray;
}
&lt;/style&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="12-组合式API">12. 组合式API</h2><h3 id="12-1-什么是组合式API">12.1 什么是组合式API</h3><p>之前我们用的是选项式API方式编写Vue组件，Vue还提供组合式API方式编写组件。</p><p><a target="_blank" rel="noopener" href="https://v3.cn.vuejs.org/guide/composition-api-introduction.html">官方文档</a>解释总结：</p><ul><li>选项式API能够很好的胜任任何中小大型项目，但是对于超大型项目（几百个以上的组件）有天生的缺陷，最显著的矛盾是<strong>逻辑关注点分离</strong>：你可能很难短时间分清哪些方法在操作哪些数据、哪些变量又被哪些组件所更改了。</li><li>组合式 API 将相同逻辑关注点代码聚合在了一起，并且很自然的支持代码复用。</li></ul><h3 id="12-2-编写组合式API">12.2 编写组合式API</h3><p>将文章列表页面 <code>ArticleList.vue</code> 的<strong>选项式API</strong>改为<strong>组合式API</strong>，本部分的所有修改只涉及到 <code>ArticleList.vue</code> 的 Javascript 脚本部分，因此先把原代码贴出来：</p><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;!-- frontend/src/components/ArticleList.vue --&gt;

&lt;script&gt;
import axios from 'axios'

export default {
  name: 'ArticleList',
  data() {
    return {
      info: '',
    }
  },
  mounted() {
    this.get_article_data()
  },
  methods: {
    // 判断标题图是否存在并返回图像
    imageIfExists(article) {
      if (article.avatar) {
        return article.avatar.content
      }
    },
    // 修改grid样式
    gridStyle(article) {
      if (article.avatar) {
        return {
          display: 'grid',
          gridTemplateColumns: '1fr 7fr'
        }
      }
    },
    // 判断页面是否存在
    is_page_exists(direction) {
      if (direction === 'next') {
        return this.info.next !== null
      }
      return this.info.previous !== null
    },
    // 获取页码
    get_page_param(direction) {
      try {
        let url_string
        switch (direction) {
          case 'next':
            url_string = this.info.next
            break
          case 'previous':
            url_string = this.info.previous
            break
          default:
            if (!('page' in this.$route.query)) {
              return 1
            }
            if (this.$route.query.page === null) {
              return 1
            }
            return this.$route.query.page
        }
        const url = new URL(url_string)
        return url.searchParams.get('page')
      } catch (err) {
        return
      }
    },
    // 获取文章列表数据
    get_article_data() {
      let url = '/api/article/'
      let params = new URLSearchParams()
      if (this.isExists(this.$route.query.page)) {
        params.append('page', this.$route.query.page)
      }
      if (this.isExists(this.$route.query.search)) {
        params.append('search', this.$route.query.search)
      }
      const paramsString = params.toString()
      if (paramsString.charAt(0) !== '') {
        url += '/?' + paramsString
      }
      axios.get(url).then(response =&gt; {
        this.info = response.data
      }).catch(error =&gt; {
        console.log(error)
      })
    },
    // 获取路径
    get_path(direction) {
      let url = ''
      try {
        switch (direction) {
          case 'next':
            if (this.info.next !== undefined) {
              url += (new URL(this.info.next)).search
            }
            break
          case 'previous':
            if (this.info.previous !== undefined) {
              url += (new URL(this.info.previous)).search
            }
            break
        }
      } catch {
        return url
      }
      return url
    },
    // 检查参数是否存在
    isExists(value) {
      return value !== null &amp;&amp; value !== undefined
    }
  },
  watch: {
    // 监听路由变化
    $route() {
      this.get_article_data()
    }
  },
  computed: {
    // 格式化时间
    formatted_time() {
      return timeString =&gt; new Date(timeString).toLocaleDateString()
    }
  }
}
&lt;/script&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown">本文标题： Django-Vue搭建个人博客(4)：前端功能完善
原文链接： https://www.dusaiphoto.com/article/122/ ~ https://www.dusaiphoto.com/article/122/
原文作者： 杜赛
许可协议： 署名-非商业性使用 4.0 国际许可协议
本文对原始作品作了修改，转载请保留原文链接及作者<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="https://xiongbinzou.github.io">小邹同学</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="https://xiongbinzou.github.io/posts/12498.html">https://xiongbinzou.github.io/posts/12498.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://xiongbinzou.github.io" target="_blank">小邹同学</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Django/">Django</a><a class="post-meta__tags" href="/tags/Django-REST-framework/">Django REST framework</a><a class="post-meta__tags" href="/tags/Vue/">Vue</a><a class="post-meta__tags" href="/tags/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/">前后端分离</a></div><div class="post_share"><div class="social-share" data-image="/pics/avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/pics/reward/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/pics/reward/wechat.jpg" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/pics/reward/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/pics/reward/alipay.jpg" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/44686.html"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">DevOps从入门到实践</div></div></a></div><div class="next-post pull-right"><a href="/posts/16431.html"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Django-Vue搭建个人博客(3)：后端功能完善</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/63190.html" title="Django-Vue搭建个人博客(0)：前言"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-02</div><div class="title">Django-Vue搭建个人博客(0)：前言</div></div></a></div><div><a href="/posts/39175.html" title="Django-Vue搭建个人博客(1)：搭建开发环境"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-03</div><div class="title">Django-Vue搭建个人博客(1)：搭建开发环境</div></div></a></div><div><a href="/posts/8442.html" title="Django-Vue搭建个人博客(2)：DRF的使用"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-04</div><div class="title">Django-Vue搭建个人博客(2)：DRF的使用</div></div></a></div><div><a href="/posts/16431.html" title="Django-Vue搭建个人博客(3)：后端功能完善"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-05</div><div class="title">Django-Vue搭建个人博客(3)：后端功能完善</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-text">1. 准备工作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%AE%89%E8%A3%85Axios"><span class="toc-text">1.1 安装Axios</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F"><span class="toc-text">1.2 解决跨域</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Vue%E7%BB%93%E6%9E%84"><span class="toc-text">2. Vue结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-index-html"><span class="toc-text">2.1 index.html</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-main-js"><span class="toc-text">2.2 main.js</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-App-vue"><span class="toc-text">2.3 App.vue</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%96%87%E7%AB%A0%E5%88%97%E8%A1%A8"><span class="toc-text">3. 文章列表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%88%9D%E6%AC%A1%E5%B0%9D%E8%AF%95"><span class="toc-text">3.1 初次尝试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E4%BC%98%E5%8C%96%E7%95%8C%E9%9D%A2"><span class="toc-text">3.2 优化界面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E6%B7%BB%E5%8A%A0%E9%A1%B5%E7%9C%89%E9%A1%B5%E8%84%9A"><span class="toc-text">3.3 添加页眉页脚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E7%BB%84%E4%BB%B6%E5%8C%96"><span class="toc-text">3.4 组件化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%96%87%E7%AB%A0%E8%AF%A6%E6%83%85"><span class="toc-text">4. 文章详情</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E4%BC%98%E5%8C%96%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="toc-text">4.1 优化文件结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E9%85%8D%E7%BD%AE%E8%B7%AF%E7%94%B1"><span class="toc-text">4.2 配置路由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E6%96%87%E7%AB%A0%E8%AF%A6%E6%83%85%E9%A1%B5%E9%9D%A2"><span class="toc-text">4.3 文章详情页面</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E7%BF%BB%E9%A1%B5%E4%B8%8E%E7%9B%91%E5%90%AC"><span class="toc-text">5. 翻页与监听</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E8%B7%AF%E7%94%B1%E4%B8%8E%E6%9F%A5%E8%AF%A2%E5%8F%82%E6%95%B0"><span class="toc-text">5.1 路由与查询参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E5%AE%9E%E7%8E%B0%E7%BF%BB%E9%A1%B5"><span class="toc-text">5.2 实现翻页</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%90%9C%E7%B4%A2%E6%96%87%E7%AB%A0"><span class="toc-text">6. 搜索文章</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E5%AE%9E%E7%8E%B0%E8%BE%93%E5%85%A5%E6%A1%86"><span class="toc-text">6.1 实现输入框</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E5%AE%9E%E7%8E%B0%E6%90%9C%E7%B4%A2"><span class="toc-text">6.2 实现搜索</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E7%94%A8%E6%88%B7%E6%B3%A8%E5%86%8C"><span class="toc-text">7. 用户注册</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E6%B3%A8%E5%86%8C%E9%A1%B5%E9%9D%A2"><span class="toc-text">7.1 注册页面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E6%B3%A8%E5%86%8C%E8%B7%AF%E7%94%B1"><span class="toc-text">7.2 注册路由</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95"><span class="toc-text">8. 用户登录</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2"><span class="toc-text">8.1 登录页面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E6%98%BE%E7%A4%BA%E7%99%BB%E5%BD%95%E7%8A%B6%E6%80%81"><span class="toc-text">8.2 显示登录状态</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E7%94%A8%E6%88%B7%E8%B5%84%E6%96%99"><span class="toc-text">9 用户资料</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-%E6%90%9C%E7%B4%A2%E6%A1%86%E7%BB%84%E4%BB%B6%E5%8C%96"><span class="toc-text">9.1 搜索框组件化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-%E5%BC%82%E6%AD%A5%E5%92%8C%E9%87%8D%E6%9E%84"><span class="toc-text">9.2 异步和重构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83"><span class="toc-text">9.3 用户中心</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1"><span class="toc-text">9.4 组件通信</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-5-%E7%94%A8%E6%88%B7%E5%88%A0%E9%99%A4"><span class="toc-text">9.5 用户删除</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E6%96%87%E7%AB%A0%E6%93%8D%E4%BD%9C"><span class="toc-text">10. 文章操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-text">10.1 准备工作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-%E5%8F%91%E5%B8%83%E6%96%87%E7%AB%A0%E7%95%8C%E9%9D%A2"><span class="toc-text">10.2 发布文章界面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-%E6%96%87%E7%AB%A0%E6%9B%B4%E6%96%B0%E4%B8%8E%E5%88%A0%E9%99%A4%E9%A1%B5%E9%9D%A2"><span class="toc-text">10.3 文章更新与删除页面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-4-%E6%96%87%E7%AB%A0%E6%A0%87%E9%A2%98%E5%9B%BE"><span class="toc-text">10.4 文章标题图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA"><span class="toc-text">11. 发布评论</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-1-%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA%E7%BB%84%E4%BB%B6"><span class="toc-text">11.1 发布评论组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-%E6%B7%BB%E5%8A%A0%E5%8F%91%E5%B8%83%E8%AF%84%E8%AE%BA%E5%8A%9F%E8%83%BD"><span class="toc-text">11.2 添加发布评论功能</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E7%BB%84%E5%90%88%E5%BC%8FAPI"><span class="toc-text">12. 组合式API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-%E4%BB%80%E4%B9%88%E6%98%AF%E7%BB%84%E5%90%88%E5%BC%8FAPI"><span class="toc-text">12.1 什么是组合式API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-2-%E7%BC%96%E5%86%99%E7%BB%84%E5%90%88%E5%BC%8FAPI"><span class="toc-text">12.2 编写组合式API</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image:url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By 小邹同学</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">你好，欢迎来到<a href="https://xiongbinzou.github.io">小邹同学的Secret Base</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",preloader.endLoading())</script><div class="js-pjax"><script>if(window.MathJax)MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typeset();else{window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],tags:"ams"},chtml:{scale:1.2},options:{renderActions:{findScript:[10,t=>{for(const e of document.querySelectorAll('script[type^="math/tex"]')){const a=!!e.type.match(/; *mode=display/),n=new t.options.MathItem(e.textContent,t.inputJax[0],a),s=document.createTextNode("");e.parentNode.replaceChild(s,e),n.start={node:s,delim:"",n:0},n.end={node:s,delim:"",n:0},t.math.push(n)}},""],insertScript:[200,()=>{document.querySelectorAll("mjx-container:not([display])").forEach((t=>{const e=t.parentNode;"li"===e.nodeName.toLowerCase()?e.parentNode.classList.add("has-jax"):e.classList.add("has-jax")}))},"",!1]}}};const t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js",t.id="MathJax-script",t.async=!0,document.head.appendChild(t)}</script><script>(()=>{const e=document.querySelectorAll("#article-container .mermaid-wrap");if(e.length){window.runMermaid=()=>{window.loadMermaid=!0;const t="dark"===document.documentElement.getAttribute("data-theme")?"dark":"default";Array.from(e).forEach(((e,n)=>{const d=e.firstElementChild,r="mermaid-"+n,i="%%{init:{ 'theme':'"+t+"'}}%%\n"+d.textContent;mermaid.mermaidAPI.render(r,i,(e=>{d.insertAdjacentHTML("afterend",e)}))}))};const t=()=>{window.loadMermaid?runMermaid():getScript("https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js").then(runMermaid)};window.pjax?t():document.addEventListener("DOMContentLoaded",t)}})()</script><script>function loadValine(){function n(){new Valine(Object.assign({el:"#vcomment",appId:"WU7g4I4cNK7LYpz3RJVoz1YV-gzGzoHsz",appKey:"4MHXbgYuTwfEzqQofOeNVquO",avatar:"monsterid",serverURLs:"",emojiMaps:"",path:window.location.pathname,visitor:!1},null))}"function"==typeof Valine?n():getScript("https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js").then(n)}{function loadOtherComment(){loadValine()}setTimeout(loadValine,0)}</script></div><div class="aplayer no-destroy" data-id="5183531430" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listfolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><script id="canvas_nest" defer color="0,0,255" opacity="0.7" zindex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,log:!1,model:{jsonPath:"/live2dw/assets/hijiki.model.json"},display:{position:"left",width:150,height:190},mobile:{show:!0},react:{opacity:1}})</script></body></html>